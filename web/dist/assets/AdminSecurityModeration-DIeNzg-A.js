import{u as z,i as K,r as t,j as e,d as X,aE as w,bE as u,w as Y,f as c,cc as O,aT as I,aG as H,F as d,X as E,R as v,ce as R,cf as D,a_ as k}from"./index-DFkuEFH9.js";const i="https://urbansetu.onrender.com";function me(){var T;z("Security Moderation - Safety Management");const{currentUser:N}=K(s=>s.user),[Q,L]=t.useState(!0),[S,g]=t.useState(""),[x,C]=t.useState({recent:[],activeLockouts:0,passwordLockouts:0}),[V,W]=t.useState(""),[Z,ee]=t.useState(""),[y,$]=t.useState([]),[se,ae]=t.useState(!1),[te,le]=t.useState(""),[re,ne]=t.useState(""),[ie,oe]=t.useState(""),[ce,de]=t.useState(""),[r,f]=t.useState({email:"",ip:"",lockedOnly:!1,captchaOnly:!1}),[l,j]=t.useState({email:"",ip:"",identifier:"",userId:""}),[q,F]=t.useState(!1),[M,U]=t.useState(!1),m=async()=>{L(!0),g("");try{const s=await fetch(`${i}/api/auth/otp/stats`,{credentials:"include"}),a=await s.json();if(!s.ok||a.success===!1)throw new Error(a.message||"Failed to fetch");const n=a.recent||[],h=n.filter(o=>o.lockoutUntil&&new Date(o.lockoutUntil)>new Date).length,b=(a.activeLockouts||0)===0&&h>0?h:a.activeLockouts||0;C({recent:n,activeLockouts:b,passwordLockouts:a.passwordLockouts||0})}catch(s){g(s.message||"Failed to load")}finally{L(!1)}},_=async()=>{F(!0),g("");try{const s=await fetch(`${i}/api/auth/otp/stats`,{credentials:"include"}),a=await s.json();if(!s.ok||a.success===!1)throw new Error(a.message||"Failed to fetch");const n=a.recent||[],h=n.filter(o=>o.lockoutUntil&&new Date(o.lockoutUntil)>new Date).length,b=(a.activeLockouts||0)===0&&h>0?h:a.activeLockouts||0;C(o=>({...o,recent:n,activeLockouts:b}))}catch(s){g(s.message||"Failed to load")}finally{F(!1)}},p=async()=>{U(!0);try{const s=await fetch(`${i}/api/auth/password-lockouts`,{credentials:"include"}),a=await s.json();if(!s.ok||a.success===!1)throw new Error(a.message||"Failed to fetch password lockouts");$(a.items||[])}catch(s){console.error(s)}finally{U(!1)}};t.useEffect(()=>{m(),p()},[]);const P=async s=>{try{await(await fetch(`${i}/api/auth/password-lockouts/unlock`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)})).json(),m(),p()}catch{}},J=async s=>{try{await(await fetch(`${i}/api/auth/password-lockouts/unlock-ip`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({ip:s})})).json(),m(),p()}catch{}},B=async s=>{try{await(await fetch(`${i}/api/auth/password-lockouts/unlock-identifier`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({identifier:s})})).json(),m(),p()}catch{}},A=t.useMemo(()=>(x.recent||[]).filter(s=>{let a=!0;return a&&r.email&&(a=(s.email||"").toLowerCase().includes(r.email.toLowerCase())),a&&r.ip&&(a=(s.ipAddress||"").toLowerCase().includes(r.ip.toLowerCase())),a&&r.captchaOnly&&(a=!!s.requiresCaptcha),a&&r.lockedOnly&&(a=s.lockoutUntil&&new Date(s.lockoutUntil)>new Date),a}),[x,r]),G=t.useMemo(()=>(y||[]).filter(s=>{let a=!0;return a&&l.email&&(a=(s.email||"").toLowerCase().includes(l.email.toLowerCase())),a&&l.ip&&(a=(s.ipAddress||"").toLowerCase().includes(l.ip.toLowerCase())),a&&l.identifier&&(a=(s.identifier||"").toLowerCase().includes(l.identifier.toLowerCase())),a&&l.userId&&(a=String(s.userId||"").toLowerCase().includes(l.userId.toLowerCase())),a}),[y,l]);return!N||N.role!=="admin"&&N.role!=="rootadmin"?e.jsx("div",{className:"p-6",children:"Unauthorized"}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-indigo-500 via-purple-500 to-blue-500 rounded-2xl shadow-xl",children:e.jsx(X,{className:"w-8 h-8 text-white"})}),e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-blue-500 rounded-2xl blur opacity-30"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold bg-gradient-to-r from-indigo-700 via-purple-700 to-blue-700 bg-clip-text text-transparent",children:"Security Moderation"}),e.jsx("p",{className:"text-gray-600 mt-2 text-lg",children:"ðŸ›¡ï¸ Monitor and manage OTP and password lockouts, requests and admin unlocks"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-red-200 p-6 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active OTP Lockouts"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:x.activeLockouts})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx(w,{className:"w-6 h-6 text-red-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-orange-200 p-6 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Password Lockouts"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:x.passwordLockouts||0})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx(u,{className:"w-6 h-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-blue-200 p-6 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Requests"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:((T=x.recent)==null?void 0:T.length)||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Y,{className:"w-6 h-6 text-blue-600"})})]})})]})]}),S&&e.jsx("div",{className:"mb-6 p-4 rounded-xl bg-red-50 border border-red-200 text-red-700 shadow-sm",children:S}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 hover:shadow-xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center mb-6 gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg",children:e.jsx(c,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Recent OTP Activity"})]}),e.jsx("button",{onClick:_,className:"ml-auto px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 flex items-center gap-2 order-2",children:q?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4"}),"Refresh"]})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(I,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{value:r.email,onChange:s=>f(a=>({...a,email:s.target.value})),placeholder:"Filter by email",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{value:r.ip,onChange:s=>f(a=>({...a,ip:s.target.value})),placeholder:"Filter by IP",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.captchaOnly,onChange:s=>f(a=>({...a,captchaOnly:s.target.checked})),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),e.jsx(E,{className:"w-3 h-3 text-orange-500"}),"Captcha only"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.lockedOnly,onChange:s=>f(a=>({...a,lockedOnly:s.target.checked})),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),e.jsx(w,{className:"w-3 h-3 text-red-500"}),"Locked only"]})]})]}),e.jsx("div",{className:"overflow-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full text-sm table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[28%]"}),e.jsx("col",{className:"w-[16%]"}),e.jsx("col",{className:"w-[8%]"}),e.jsx("col",{className:"w-[8%]"}),e.jsx("col",{className:"w-[10%]"}),e.jsx("col",{className:"w-[12%]"}),e.jsx("col",{className:"w-[12%]"}),e.jsx("col",{className:"w-[6%]"})]}),e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{className:"text-left text-gray-700",children:[e.jsx("th",{className:"py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(c,{className:"w-3 h-3"}),"Email"]})}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(d,{className:"w-3 h-3"}),"IP"]})}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Requests"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Fails"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Captcha"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Lockout"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[A.map((s,a)=>e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors duration-200",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.email||"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm text-gray-600",children:s.ipAddress||"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s.otpRequestCount||0})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.failedOtpAttempts>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.failedOtpAttempts||0})}),e.jsx("td",{className:"py-3 px-4",children:s.requiresCaptcha?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[e.jsx(E,{className:"w-3 h-3"}),"Yes"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(v,{className:"w-3 h-3"}),"No"]})}),e.jsx("td",{className:"py-3 px-4",children:s.lockoutUntil&&new Date(s.lockoutUntil)>new Date?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:"text-xs text-red-600 font-medium",children:new Date(s.lockoutUntil).toLocaleString()})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.updatedAt?new Date(s.updatedAt).toLocaleString():"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("button",{onClick:async()=>{try{s.email?await(await fetch(`${i}/api/auth/otp/unlock-email`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:s.email})})).json():s.ipAddress&&await(await fetch(`${i}/api/auth/otp/unlock-ip`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({ip:s.ipAddress})})).json()}catch{}m()},className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",title:"Unlock restriction",children:[e.jsx(D,{className:"w-3 h-3"}),"Unlock"]})})]},a)),A.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-8 text-center text-gray-500",colSpan:"8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(v,{className:"w-8 h-8 text-green-500"}),e.jsx("span",{className:"text-lg font-medium",children:"No recent OTP activity"}),e.jsx("span",{className:"text-sm",children:"All clear. No OTP lockouts or requests to show"})]})})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 hover:shadow-xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Active Password Lockouts"})]}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 flex items-center gap-2",children:M?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4"}),"Refresh"]})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(I,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Password Lockout Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{value:l.email,onChange:s=>j(a=>({...a,email:s.target.value})),placeholder:"Filter by email",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{value:l.userId,onChange:s=>j(a=>({...a,userId:s.target.value})),placeholder:"Filter by User ID",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{value:l.ip,onChange:s=>j(a=>({...a,ip:s.target.value})),placeholder:"Filter by IP",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{value:l.identifier,onChange:s=>j(a=>({...a,identifier:s.target.value})),placeholder:"Filter by Identifier",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]})]})]}),e.jsx("div",{className:"overflow-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full text-sm table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[24%]"}),e.jsx("col",{className:"w-[14%]"}),e.jsx("col",{className:"w-[16%]"}),e.jsx("col",{className:"w-[16%]"}),e.jsx("col",{className:"w-[8%]"}),e.jsx("col",{className:"w-[8%]"}),e.jsx("col",{className:"w-[10%]"}),e.jsx("col",{className:"w-[8%]"})]}),e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{className:"text-left text-gray-700",children:[e.jsx("th",{className:"py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(c,{className:"w-3 h-3"}),"Email"]})}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(k,{className:"w-3 h-3"}),"User ID"]})}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(d,{className:"w-3 h-3"}),"IP"]})}),e.jsx("th",{className:"py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(u,{className:"w-3 h-3"}),"Identifier"]})}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Attempts"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Locked"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Unlock At"}),e.jsx("th",{className:"py-3 px-4 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[G.map(s=>e.jsxs("tr",{className:"hover:bg-orange-50 transition-colors duration-200",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.email||"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm text-gray-600",children:s.userId||"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm text-gray-600",children:s.ipAddress||"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm text-gray-600",children:s.identifier||"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.attempts>3?"bg-red-100 text-red-800":s.attempts>1?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:s.attempts||0})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.lockedAt?new Date(s.lockedAt).toLocaleString():"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.unlockAt?new Date(s.unlockAt).toLocaleString():"-"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("button",{onClick:async()=>{try{s.email?await P({email:s.email}):s.userId?await P({userId:s.userId}):s.ipAddress?await J(s.ipAddress):s.identifier&&await B(s.identifier)}catch{}},className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",title:"Unlock password restriction",children:[e.jsx(D,{className:"w-3 h-3"}),"Unlock"]})})]},s._id)),y.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-8 text-center text-gray-500",colSpan:"8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(v,{className:"w-8 h-8 text-green-500"}),e.jsx("span",{className:"text-lg font-medium",children:"No active password lockouts"}),e.jsx("span",{className:"text-sm",children:"All users can access their accounts normally"})]})})})]})]})})]})]})]})})}export{me as default};
