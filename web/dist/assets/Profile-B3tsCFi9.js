import{u as Is,am as Fs,m as Us,r as s,k as _s,bw as h,j as e,aW as ze,U as Vt,bx as fe,f as Ht,g as Bt,ah as ba,a0 as et,z as he,M as Jt,H as f,y as C,T as ya,ar as Wt,p as Yt,L as x,b as Ms,bb as qt,R as Gt,by as at,bz as Zt,d as Kt,bA as zs,bB as Ls,C as Vs,bC as Hs,bD as Bs,bE as Le,bF as va,bG as ge,bH as Ve,bI as He,x as tt,bJ as Js,J as Z,bK as Xt}from"./index-WPqAAPOK.js";import{R as Qt}from"./RecaptchaWidget-Bkojglzv.js";const st=["https://api.dicebear.com/7.x/bottts/svg?seed=${name}","https://randomuser.me/api/portraits/men/1.jpg","https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/women/2.jpg","https://randomuser.me/api/portraits/men/3.jpg","https://randomuser.me/api/portraits/women/3.jpg","https://randomuser.me/api/portraits/lego/1.jpg","https://randomuser.me/api/portraits/lego/2.jpg","https://randomuser.me/api/portraits/lego/3.jpg","https://api.dicebear.com/6.x/bottts/svg?seed=avatar0","https://api.dicebear.com/6.x/bottts/svg?seed=avatar1","https://api.dicebear.com/6.x/bottts/svg?seed=avatar2","https://api.dicebear.com/6.x/bottts/svg?seed=avatar3","https://api.dicebear.com/6.x/bottts/svg?seed=avatar4","https://api.dicebear.com/6.x/bottts/svg?seed=avatar5","https://api.dicebear.com/6.x/bottts/svg?seed=avatar6","https://api.dicebear.com/6.x/bottts/svg?seed=avatar7","https://api.dicebear.com/6.x/bottts/svg?seed=avatar8","https://api.dicebear.com/6.x/bottts/svg?seed=avatar9","https://api.dicebear.com/6.x/bottts/svg?seed=avatar10","https://api.dicebear.com/6.x/bottts/svg?seed=avatar11","https://api.dicebear.com/6.x/bottts/svg?seed=avatar12","https://api.dicebear.com/6.x/bottts/svg?seed=avatar13","https://api.dicebear.com/6.x/bottts/svg?seed=avatar14","https://api.dicebear.com/6.x/bottts/svg?seed=avatar15"],Ws={seed:{type:"string"},flip:{type:"boolean",default:!1},rotate:{type:"integer",minimum:0,maximum:360,default:0},scale:{type:"integer",minimum:0,maximum:200,default:100},radius:{type:"integer",minimum:0,maximum:50,default:0},size:{type:"integer",minimum:1},backgroundColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["65c9ff"]},backgroundType:{type:"array",items:{type:"string",enum:["solid","gradientLinear"]},default:["solid"]},backgroundRotation:{type:"array",items:{type:"integer",minimum:-360,maximum:360},default:[0,360]},translateX:{type:"integer",minimum:-100,maximum:100,default:0},translateY:{type:"integer",minimum:-100,maximum:100,default:0},clip:{type:"boolean",default:!0},randomizeIds:{type:"boolean",default:!1},accessories:{type:"array",items:{type:"string",enum:["kurt","prescription01","prescription02","round","sunglasses","wayfarers","eyepatch"]},default:["kurt","prescription01","prescription02","round","sunglasses","wayfarers","eyepatch"]},accessoriesColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["262e33","65c9ff","5199e4","25557c","e6e6e6","929598","3c4f5c","b1e2ff","a7ffc4","ffdeb5","ffafb9","ffffb1","ff488e","ff5c5c","ffffff"]},accessoriesProbability:{type:"integer",minimum:0,maximum:100,default:10},base:{type:"array",items:{type:"string",enum:["default"]},default:["default"]},clothesColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["262e33","65c9ff","5199e4","25557c","e6e6e6","929598","3c4f5c","b1e2ff","a7ffc4","ffafb9","ffffb1","ff488e","ff5c5c","ffffff"]},clothing:{type:"array",items:{type:"string",enum:["blazerAndShirt","blazerAndSweater","collarAndSweater","graphicShirt","hoodie","overall","shirtCrewNeck","shirtScoopNeck","shirtVNeck"]},default:["blazerAndShirt","blazerAndSweater","collarAndSweater","graphicShirt","hoodie","overall","shirtCrewNeck","shirtScoopNeck","shirtVNeck"]},clothingGraphic:{type:"array",items:{type:"string",enum:["bat","bear","cumbia","deer","diamond","hola","pizza","resist","skull","skullOutline"]},default:["bat","bear","cumbia","deer","diamond","hola","pizza","resist","skull","skullOutline"]},eyebrows:{type:"array",items:{type:"string",enum:["angryNatural","defaultNatural","flatNatural","frownNatural","raisedExcitedNatural","sadConcernedNatural","unibrowNatural","upDownNatural","angry","default","raisedExcited","sadConcerned","upDown"]},default:["angryNatural","defaultNatural","flatNatural","frownNatural","raisedExcitedNatural","sadConcernedNatural","unibrowNatural","upDownNatural","angry","default","raisedExcited","sadConcerned","upDown"]},eyes:{type:"array",items:{type:"string",enum:["closed","cry","default","eyeRoll","happy","hearts","side","squint","surprised","winkWacky","wink","xDizzy"]},default:["closed","cry","default","eyeRoll","happy","hearts","side","squint","surprised","winkWacky","wink","xDizzy"]},facialHair:{type:"array",items:{type:"string",enum:["beardLight","beardMajestic","beardMedium","moustacheFancy","moustacheMagnum"]},default:["beardLight","beardMajestic","beardMedium","moustacheFancy","moustacheMagnum"]},facialHairColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["a55728","2c1b18","b58143","d6b370","724133","4a312c","f59797","ecdcbf","c93305","e8e1e1"]},facialHairProbability:{type:"integer",minimum:0,maximum:100,default:10},hairColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["a55728","2c1b18","b58143","d6b370","724133","4a312c","f59797","ecdcbf","c93305","e8e1e1"]},hatColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["262e33","65c9ff","5199e4","25557c","e6e6e6","929598","3c4f5c","b1e2ff","a7ffc4","ffdeb5","ffafb9","ffffb1","ff488e","ff5c5c","ffffff"]},mouth:{type:"array",items:{type:"string",enum:["concerned","default","disbelief","eating","grimace","sad","screamOpen","serious","smile","tongue","twinkle","vomit"]},default:["concerned","default","disbelief","eating","grimace","sad","screamOpen","serious","smile","tongue","twinkle","vomit"]},nose:{type:"array",items:{type:"string",enum:["default"]},default:["default"]},skinColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["614335","d08b5b","ae5d29","edb98a","ffdbb4","fd9841","f8d25c"]},style:{type:"array",items:{type:"string",enum:["circle","default"]},default:["default"]},top:{type:"array",items:{type:"string",enum:["hat","hijab","turban","winterHat1","winterHat02","winterHat03","winterHat04","bob","bun","curly","curvy","dreads","frida","fro","froBand","longButNotTooLong","miaWallace","shavedSides","straight02","straight01","straightAndStrand","dreads01","dreads02","frizzle","shaggy","shaggyMullet","shortCurly","shortFlat","shortRound","shortWaved","sides","theCaesar","theCaesarAndSidePart","bigHair"]},default:["hat","hijab","turban","winterHat1","winterHat02","winterHat03","winterHat04","bob","bun","curly","curvy","dreads","frida","fro","froBand","longButNotTooLong","miaWallace","shavedSides","straight02","straight01","straightAndStrand","dreads01","dreads02","frizzle","shaggy","shaggyMullet","shortCurly","shortFlat","shortRound","shortWaved","sides","theCaesar","theCaesarAndSidePart","bigHair"]},topProbability:{type:"integer",minimum:0,maximum:100,default:100}},ja={properties:Ws},d="https://urbansetu.onrender.com",l={fadeInUp:"animate-[fadeInUp_0.6s_ease-out_forwards] opacity-0 translate-y-8",fadeInLeft:"animate-[fadeInLeft_0.6s_ease-out_forwards] opacity-0 -translate-x-8",fadeInRight:"animate-[fadeInRight_0.6s_ease-out_forwards] opacity-0 translate-x-8",scaleIn:"animate-[scaleIn_0.5s_ease-out_forwards] opacity-0 scale-95",slideInUp:"animate-[slideInUp_0.5s_ease-out_forwards] opacity-0 translate-y-4",bounceIn:"animate-[bounceIn_0.7s_ease-out_forwards] opacity-0 scale-50",pulse:"animate-pulse",bounce:"animate-bounce",wiggle:"animate-[wiggle_1s_ease-in-out_infinite]",heartbeat:"animate-[heartbeat_1.5s_ease-in-out_infinite]",float:"animate-[float_3s_ease-in-out_infinite]"},Ys=`
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes fadeInLeft {
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
}
@keyframes fadeInRight {
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.8); }
  to { opacity: 1; transform: scale(1); }
}
@keyframes slideInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes bounceIn {
  0% { opacity: 0; transform: scale(0.3); }
  50% { opacity: 1; transform: scale(1.05); }
  70% { transform: scale(0.9); }
  100% { opacity: 1; transform: scale(1); }
}
@keyframes wiggle {
  0%, 7% { transform: rotateZ(0); }
  15% { transform: rotateZ(-15deg); }
  20% { transform: rotateZ(10deg); }
  25% { transform: rotateZ(-10deg); }
  30% { transform: rotateZ(6deg); }
  35% { transform: rotateZ(-4deg); }
  40%, 100% { transform: rotateZ(0); }
}
@keyframes heartbeat {
  0%, 50%, 100% { transform: scale(1); }
  25% { transform: scale(1.1); }
}
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
@keyframes shimmer {
  0% { background-position: -200px 0; }
  100% { background-position: calc(200px + 100%) 0; }
}
@keyframes countUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
.animation-delay-0 { animation-delay: 0ms; }
.animation-delay-150 { animation-delay: 150ms; }
.animation-delay-300 { animation-delay: 300ms; }
.animation-delay-450 { animation-delay: 450ms; }
.animation-delay-600 { animation-delay: 600ms; }
.animation-delay-750 { animation-delay: 750ms; }
`,qs=[{key:"adventurer",label:"Adventurer"},{key:"adventurer-neutral",label:"Adventurer Neutral"},{key:"avataaars",label:"Avataaars"},{key:"avataaars-neutral",label:"Avataaars Neutral"},{key:"big-ears",label:"Big Ears"},{key:"big-ears-neutral",label:"Big Ears Neutral"},{key:"big-smile",label:"Big Smile"},{key:"bottts",label:"Bottts"},{key:"bottts-neutral",label:"Bottts Neutral"},{key:"croodles",label:"Croodles"},{key:"croodles-neutral",label:"Croodles Neutral"},{key:"dylan",label:"Dylan"},{key:"fun-emoji",label:"Fun Emoji"},{key:"glass",label:"Glass"},{key:"icons",label:"Icons"},{key:"identicon",label:"Identicon"},{key:"initials",label:"Initials"},{key:"lorelei",label:"Lorelei"},{key:"lorelei-neutral",label:"Lorelei Neutral"},{key:"micah",label:"Micah"},{key:"miniavs",label:"Miniavs"},{key:"notionists",label:"Notionists"},{key:"notionists-neutral",label:"Notionists Neutral"},{key:"open-peeps",label:"Open Peeps"},{key:"personas",label:"Personas"},{key:"pixel-art",label:"Pixel Art"},{key:"pixel-art-neutral",label:"Pixel Art Neutral"},{key:"rings",label:"Rings"},{key:"shapes",label:"Shapes"},{key:"thumbs",label:"Thumbs"}],Gs=["style","seed","flip","rotate"],wa=({end:t,duration:Na=1e3,delay:pe=0})=>{const[m,o]=s.useState(0),[V,Sa]=s.useState(!1);return s.useEffect(()=>{const xe=setTimeout(()=>{Sa(!0);let K=0;const X=t/(Na/50),y=setInterval(()=>{K+=X,K>=t?(o(t),clearInterval(y)):o(Math.floor(K))},50);return()=>clearInterval(y)},pe);return()=>clearTimeout(xe)},[t,Na,pe]),e.jsx("span",{className:`${V?"animate-[countUp_0.6s_ease-out_forwards]":"opacity-0"}`,children:m})};function ar(){const{currentUser:t,error:Na}=Is(a=>a.user),{wishlist:pe}=Fs(),m=Us(),[o,V]=s.useState({avatar:(t==null?void 0:t.avatar)||""}),[Sa,xe]=s.useState(!1),[K,X]=s.useState(""),[y,ka]=s.useState(!1),[w,Be]=s.useState({listings:0,appointments:0,wishlist:0,watchlist:0}),[be,Je]=s.useState(!1),[rt,es]=s.useState([]),Pa=s.useRef(null);s.useRef(null);const $a=s.useRef(null),Ta=s.useRef(null),[We,Ye]=s.useState(""),[lt,qe]=s.useState(!1),[Q,Ge]=s.useState(!1),[Ca,ye]=s.useState(!1),[Ze,nt]=s.useState(""),[it,ve]=s.useState(""),[Ke,Aa]=s.useState(""),[W,Ea]=s.useState(!1),[ot,Y]=s.useState(""),[as,ts]=s.useState(0),[ss,Zs]=s.useState(!1),[H,Oa]=s.useState(0),[rs,Ra]=s.useState(!0),[Xe,dt]=s.useState(!1),[je,ct]=s.useState(""),[mt,ut]=s.useState(""),[Qe,ea]=s.useState(!1),[ee,Da]=s.useState(!1),[we,Ne]=s.useState(!1),[Se,Ia]=s.useState(!1),[ft,ht]=s.useState(!1),[Fa,ke]=s.useState(!1),[aa,Ua]=s.useState(""),[gt,ae]=s.useState(""),[pt,_a]=s.useState(!1),[Pe,ta]=s.useState(!1),[$e,Te]=s.useState(!1),[M,B]=s.useState(""),[N,te]=s.useState(!1),[xt,A]=s.useState(""),[bt,yt]=s.useState(0),[S,z]=s.useState(0),[vt,L]=s.useState(!0),[Ma,se]=s.useState(!1),[jt,za]=s.useState([]),[sa,La]=s.useState(""),[Ce,Va]=s.useState(""),[ra,k]=s.useState(""),[re,la]=s.useState(!1),[Ks,ls]=s.useState(!1),[Ae,na]=s.useState(!1),[Ee,Oe]=s.useState(!1),[ia,Ha]=s.useState(!1),[oa,le]=s.useState(""),[da,ne]=s.useState(""),[J,E]=s.useState(!1),[ns,O]=s.useState(!1),[Ba,R]=s.useState(""),[wt,Ja]=s.useState("");s.useEffect(()=>(Ca||Fa||Ma||be?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[Ca,Fa,Ma,be]),s.useEffect(()=>{let a;return H>0&&(a=setTimeout(()=>Oa(r=>r-1),1e3)),()=>{a&&clearTimeout(a)}},[H]),s.useEffect(()=>{let a;return S>0&&(a=setTimeout(()=>z(r=>r-1),1e3)),()=>{a&&clearTimeout(a)}},[S]),s.useEffect(()=>{H<=0&&Ra(!0)},[H]),s.useEffect(()=>{S<=0&&L(!0)},[S]),s.useEffect(()=>{W&&Pa.current&&Pa.current.focus()},[W]),s.useEffect(()=>{N&&Ta.current&&Ta.current.focus()},[N]),s.useEffect(()=>{N&&$a.current&&$a.current.focus()},[N]);const[c,D]=s.useState({loading:!1,message:"",available:null}),[p,ie]=s.useState({loading:!1,message:"",available:null}),[Re,is]=s.useState(null),[De,os]=s.useState(null),[j,ds]=s.useState(""),[Wa,Nt]=s.useState(""),[$,I]=s.useState(!1),[F,T]=s.useState(!1),[oe,U]=s.useState(""),[q,St]=s.useState(!1),[de,kt]=s.useState(!1),[ca,P]=s.useState(""),[v,ma]=s.useState(!1),Ya=s.useRef(null),[Ie,qa]=s.useState(0),[Pt,Ga]=s.useState(!0),[Fe,ua]=s.useState(null),[fa,ce]=s.useState(""),[$t,me]=s.useState(!1),[Ue,Za]=s.useState(!1),[Tt,Ka]=s.useState(0),ha=s.useRef(null),[_,cs]=s.useState(!1),[ga,ms]=s.useState(!1),g=_s();window.location.pathname.startsWith("/admin");const pa=t&&(t.role==="admin"||t.role==="rootadmin");s.useEffect(()=>{const a=document.createElement("style");a.textContent=Ys,document.head.appendChild(a);const r=setTimeout(()=>cs(!0),100);return()=>{document.head.removeChild(a),clearTimeout(r)}},[]),s.useEffect(()=>{(w.listings>0||w.appointments>0||w.wishlist>0)&&ms(!0)},[w]),s.useEffect(()=>{t&&(ds(t.email||""),Nt(t.mobileNumber||""),t.email&&D({loading:!1,message:"",available:!0}))},[t]),s.useEffect(()=>{t&&fs()},[t]),s.useEffect(()=>{t&&Be(a=>({...a,wishlist:pe.length}))},[pe,t]);const us=async()=>{if(!(t!=null&&t._id))return 0;try{const a=await fetch(`${d}/api/watchlist/user/${t._id}`,{credentials:"include"});if(a.ok)return(await a.json()).length||0}catch(a){console.error("Error fetching watchlist count:",a)}return 0};s.useEffect(()=>{let a=null;return Ie>0&&(a=setInterval(()=>{qa(r=>r<=1?(Ga(!0),0):r-1)},1e3)),()=>{a&&clearInterval(a)}},[Ie]),s.useEffect(()=>()=>{Re&&clearTimeout(Re),De&&clearTimeout(De)},[Re,De]);const fs=async()=>{try{const a=await us();if(t&&(t.role==="admin"||t.role==="rootadmin")){const[r,n]=await Promise.all([h(`${d}/api/listing/user`),h(`${d}/api/bookings/`)]),i=await r.json(),u=await n.json();Be(b=>({listings:Array.isArray(i)?i.filter(G=>G.userRef===t._id).length:0,appointments:Array.isArray(u)?u.length:0,wishlist:b.wishlist,watchlist:a}))}else{const[r,n]=await Promise.all([h(`${d}/api/listing/user`),h(`${d}/api/bookings/user/${t._id}`)]),i=await r.json(),u=await n.json();Be(b=>({listings:Array.isArray(i)?i.length:0,appointments:Array.isArray(u)?u.length:0,wishlist:b.wishlist,watchlist:a}))}}catch(a){console.error("[fetchUserStats] Error fetching user stats:",a),Be(r=>({listings:0,appointments:0,wishlist:r.wishlist,watchlist:0}))}},Ct=async a=>{if(!a.trim()){D({loading:!1,message:"",available:null}),I(!1),T(!1),U("");return}if(!a.includes("@")){D({loading:!1,message:"Enter a valid email",available:!1}),I(!1),T(!1),U("");return}if(a===j){D({loading:!1,message:"",available:!0}),I(!0),T(!1),U("");return}try{D({loading:!0,message:"",available:null}),(await(await h(`${d}/api/user/check-email/${encodeURIComponent(a.trim())}`)).json()).available===!1?(D({loading:!1,message:"Email already exists. Please use a different one.",available:!1}),I(!1),T(!1),U("")):(D({loading:!1,message:"Email is available. Click 'Send OTP' to verify.",available:!0}),I(!1),T(!1),U(""))}catch{D({loading:!1,message:"Error checking email availability",available:!1}),I(!1),T(!1),U("")}},At=async a=>{if(!a.trim()){ie({loading:!1,message:"",available:null});return}if(!/^[0-9]{10}$/.test(a)){ie({loading:!1,message:"Enter a valid 10-digit mobile number",available:!1});return}if(a===Wa){ie({loading:!1,message:"",available:!0});return}try{ie({loading:!0,message:"",available:null});const n=await(await h(`${d}/api/user/check-mobile/${encodeURIComponent(a.trim())}`)).json();ie({loading:!1,message:n.message,available:n.available})}catch{ie({loading:!1,message:"Error checking mobile availability",available:!1})}},hs=a=>{Re&&clearTimeout(Re);const r=setTimeout(()=>Ct(a),300);is(r)},gs=a=>{De&&clearTimeout(De);const r=setTimeout(()=>At(a),300);os(r)},Et=a=>{ua(a),ce(""),setTimeout(()=>me(!1),1e3)},Ot=()=>{ua(null),ce("reCAPTCHA expired. Please verify again."),Ka(a=>a+1),me(!0)},Rt=a=>{ua(null),ce("reCAPTCHA verification failed. Please try again."),Ka(r=>r+1),me(!0)},ps=()=>{ha.current&&ha.current.reset(),ua(null),ce(""),Ka(a=>a+1)},Dt=async()=>{if(!o.email){P("Please enter an email address first");return}if(Pt){if(Ue&&!Fe){P("Please complete the reCAPTCHA verification first");return}St(!0),P("");try{const a={email:o.email};Ue&&Fe&&(a.recaptchaToken=Fe);const n=await(await h(`${d}/api/auth/send-profile-email-otp`,{method:"POST",body:JSON.stringify(a)})).json();n.success?(T(!0),f.success("OTP sent successfully to your email"),D({loading:!1,available:!0}),Ue&&(ps(),me(!1),Za(!1)),qa(30),Ga(!1),setTimeout(()=>{Ya.current&&Ya.current.focus()},100)):n.requiresCaptcha?(Za(!0),me(!0),ce("reCAPTCHA verification is required due to multiple failed attempts or requests"),P("")):P(n.message)}catch{P("Failed to send OTP. Please try again.")}finally{St(!1)}}},It=async()=>{if(!oe){P("Please enter the OTP");return}kt(!0),P("");try{const r=await(await h(`${d}/api/auth/verify-otp`,{method:"POST",body:JSON.stringify({email:o.email,otp:oe})})).json();r.success?(I(!0),f.success("Email verified successfully!"),T(!1),U(""),ma(!1),D({loading:!1,message:"Email verified successfully!",available:!0})):r.requiresCaptcha?(Za(!0),me(!0),ce("reCAPTCHA verification is required due to multiple failed attempts or requests"),P("")):P(r.message)}catch{P("Failed to verify OTP. Please try again.")}finally{kt(!1)}},_e=a=>{const{id:r}=a.target;let{value:n}=a.target;r==="mobileNumber"&&(n=n.replace(/[^0-9]/g,"")),V({...o,[r]:n}),r==="email"?le(""):r==="mobileNumber"&&ne(""),r==="email"?(v&&(I(!1),T(!1),U("")),hs(n)):r==="mobileNumber"&&gs(n)},xs=async a=>{if(a.preventDefault(),X(""),xe(!1),le(""),ne(""),!o.email||!o.email.trim()){le("Please provide valid email id");return}if(c.available===!1){le("Email already exists. Please use a different one.");return}if(p.available===!1){ne("Mobile number already exists. Please use a different one.");return}if(!o.mobileNumber||!/^[0-9]{10}$/.test(o.mobileNumber)){ne("Please provide a valid 10-digit mobile number");return}if(o.email!==j&&!$){le("Please verify your new email with OTP before saving.");return}O(!0)},Ft=async()=>{if(Ja(""),!Ba){Ja("Password is required");return}E(!0);try{m(Hs());const a=`${d}/api/user/update/${t._id}`,r=Bs({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,avatar:o.avatar===void 0?"":o.avatar,password:Ba})}),i=await(await fetch(a,r)).json();if(i.status==="email_exists"){f.error("Email already registered. Please use a different one."),le("Email already registered. Please use a different one."),m(Le("Email already registered. Please use a different one.")),E(!1),O(!1),R("");return}if(i.status==="mobile_exists"){f.error("Mobile number already in use. Please choose another one."),ne("Mobile number already in use. Please choose another one."),m(Le("Mobile number already in use. Please choose another one.")),E(!1),O(!1),R("");return}if(i.status==="mobile_invalid"){ne("Please provide a valid 10-digit mobile number"),m(Le("Please provide a valid 10-digit mobile number")),E(!1),O(!1),R("");return}if(i.status==="invalid_password"){O(!1),R(""),E(!1),f.error("You have been signed out for security reasons. No changes were made to your profile."),m(va());try{const b=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();b.success===!1?m(ge(b.message)):(m(Ve(b)),He&&He.purge&&await He.purge(),tt(),localStorage.removeItem("accessToken"),document.cookie="access_token=; Max-Age=0; path=/; domain="+window.location.hostname+"; secure; samesite=None")}catch(u){m(ge(u.message))}setTimeout(()=>{g("/sign-in",{replace:!0})},800);return}if(i.status==="success"){const u={...i.updatedUser,avatar:i.updatedUser.avatar||"",isGeneratedMobile:i.updatedUser.mobileNumber&&i.updatedUser.mobileNumber!==Wa?!1:i.updatedUser.isGeneratedMobile};m(Js(u)),i.updatedUser.mobileNumber&&i.updatedUser.mobileNumber!==Wa&&Nt(i.updatedUser.mobileNumber),Z.emit("profileUpdated",{userId:u._id,username:u.username,avatar:u.avatar,mobileNumber:u.mobileNumber,email:u.email}),xe(!0),ka(!1),E(!1),O(!1),R(""),f.success("Profile Updated Successfully!!"),setTimeout(()=>{xe(!1)},3e3);return}if(i.success===!1||i.status==="error"){X(i.message||"Profile Update Failed!"),m(Le(i.message)),E(!1),O(!1),R("");return}X("Profile Update Failed!"),E(!1),O(!1),R("")}catch(a){X("Profile Update Failed!"),m(Le(a.message)),E(!1),O(!1),R("")}},bs=async()=>{if(t.isDefaultAdmin){Ye(""),Je(!0);return}ye(!0)},ys=async()=>{if(ve(""),!Ze){ve("Password is required");return}if(ea(!0),!(await h(`${d}/api/auth/verify-password`,{method:"POST",body:JSON.stringify({password:Ze})})).ok){ye(!1),f.error("For security reasons, you've been signed out automatically."),m(va());const n=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();n.success===!1?m(ge(n.message)):m(Ve(n)),g("/sign-in",{replace:!0}),ea(!1);return}ht(!0),dt(!0),ea(!1)},vs=async()=>{Y(""),Aa(""),Ea(!1);try{Da(!0);const a=await h(`${d}/api/auth/send-account-deletion-otp`,{method:"POST",body:JSON.stringify({email:t.email})}),r=await a.json();if(!a.ok||r.success===!1){ve(r.message||"Failed to send OTP");return}Ea(!0),Ra(!1),Oa(30)}finally{Da(!1)}},js=async()=>{try{Ia(!0);const a=await h(`${d}/api/auth/send-account-deletion-otp`,{method:"POST",body:JSON.stringify({email:t.email})}),r=await a.json();return a.ok&&r.success!==!1}catch{return!1}finally{Ia(!1)}},ws=async()=>{if(Y(""),!Ke||Ke.length!==6){Y("Enter 6-digit OTP");return}try{Ne(!0);const a=await h(`${d}/api/auth/verify-otp`,{method:"POST",body:JSON.stringify({email:t.email,otp:Ke})}),r=await a.json();if(!a.ok||r.success===!1||r.type!=="account_deletion"){const Lt=as+1;if(ts(Lt),Y(r.message||"Invalid OTP"),Lt>=5){ye(!1),f.error("For security reasons, you've been signed out automatically."),m(va());const Qa=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();Qa.success===!1?m(ge(Qa.message)):m(Ve(Qa)),g("/sign-in",{replace:!0});return}Ne(!1);return}const n=`${d}/api/user/delete/${t._id}`,u={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:Ze,reason:je==="other"?"other":je,otherReason:je==="other"?mt:void 0}),credentials:"include"},b=await h(n,u),G=await b.json();if(!b.ok){ve(G.message||"Account deletion failed"),Ne(!1);return}m(Xt(G)),ye(!1),f.success("Account deleted successfully. Thank you for being with us — we hope to serve you again in the future!"),g("/")}catch{Y("Verification failed")}finally{Ne(!1)}},Ns=async()=>{try{qe(!0);const a=await fetch(`${d}/api/user/approved-admins/${t._id}`,{credentials:"include"}),r=await a.json();a.ok?es(r):f.error(r.message||"Failed to fetch admins")}catch{f.error("Error fetching admins")}finally{qe(!1)}},Ss=async()=>{if(!We){f.error("Please select an admin to transfer default admin rights to");return}ke(!0),Ua(""),ae(""),te(!1),B(""),A(""),_a(!1),Ge(!1),ta(!1),Te(!1),L(!0),z(0)},ks=async()=>{if(ae(""),!aa){ae("Password is required");return}try{if(Ge(!0),!(await h(`${d}/api/auth/verify-password`,{method:"POST",body:JSON.stringify({password:aa})})).ok){ke(!1),f.error("For security reasons, you've been signed out automatically."),await fetch(`${d}/api/auth/signout`,{credentials:"include"}),g("/sign-in",{replace:!0});return}const r=await h(`${d}/api/auth/send-transfer-rights-otp`,{method:"POST",body:JSON.stringify({email:t.email})}),n=await r.json();if(!r.ok||n.success===!1){ae(n.message||"Failed to send OTP");return}_a(!0),B(""),te(!0),L(!1),z(30)}catch{ae("Failed to verify password")}finally{Ge(!1)}},Ut=async()=>{try{na(!0),ta(!0);const a=await h(`${d}/api/auth/send-transfer-rights-otp`,{method:"POST",body:JSON.stringify({email:t.email})}),r=await a.json();return a.ok&&r.success!==!1}catch{return!1}finally{na(!1),ta(!1)}},Ps=async()=>{if(A(""),!M||M.length!==6){A("Enter 6-digit OTP");return}try{Te(!0);const a=await h(`${d}/api/auth/verify-otp`,{method:"POST",body:JSON.stringify({email:t.email,otp:M})}),r=await a.json();if(!a.ok||r.success===!1||r.type!=="forgotPassword"){const G=bt+1;yt(G),A(r.message||"Invalid OTP"),G>=5&&(ke(!1),f.error("For security reasons, you've been signed out automatically."),await fetch(`${d}/api/auth/signout`,{credentials:"include"}),g("/sign-in",{replace:!0})),Te(!1);return}const n=await fetch(`${d}/api/user/transfer-default-admin`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentAdminId:t._id,newDefaultAdminId:We})}),i=await n.json();if(!n.ok){A(i.message||"Failed to transfer default admin rights");return}const u=await fetch(`${d}/api/user/delete/${t._id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:aa})}),b=await u.json();if(!u.ok){A(b.message||"Failed to delete account after transfer");return}m(Xt(b)),Je(!1),ke(!1),f.success("Admin rights transferred and account deleted successfully!"),g("/")}catch{A("Verification failed")}finally{Te(!1)}},$s=async a=>{a.preventDefault();try{m(va());const n=await(await fetch(`${d}/api/auth/signout`,{credentials:"include"})).json();n.success===!1?m(ge(n.message)):(m(Ve(n)),await He.purge(),localStorage.removeItem("accessToken"),document.cookie="access_token=; Max-Age=0; path=/; SameSite=None; Secure",document.cookie="refresh_token=; Max-Age=0; path=/; SameSite=None; Secure",document.cookie="session_id=; Max-Age=0; path=/; SameSite=None; Secure",Z&&Z.connected&&Z.disconnect(),tt(),f.info("You have been signed out."),await new Promise(i=>setTimeout(i,50)),g("/",{replace:!0}))}catch(r){m(ge(r.message)),m(Ve()),await He.purge(),localStorage.removeItem("accessToken"),document.cookie="access_token=; Max-Age=0; path=/; SameSite=None; Secure",document.cookie="refresh_token=; Max-Age=0; path=/; SameSite=None; Secure",document.cookie="session_id=; Max-Age=0; path=/; SameSite=None; Secure",Z&&Z.connected&&Z.disconnect(),tt(),f.info("You have been signed out."),g("/",{replace:!0})}},Ts=()=>{t&&(t.role==="admin"||t.role==="rootadmin")?g("/admin/my-listings"):g("/user/my-listings")},Cs=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});s.useEffect(()=>{be&&Ns()},[be]);const As=async()=>{try{qe(!0);const a=await fetch(`${d}/api/admin/management/admins`,{credentials:"include"}),r=await a.json();a.ok?za(r.filter(n=>n.role==="admin"||n.role==="rootadmin")):za([])}catch{za([])}finally{qe(!1)}},Es=()=>{se(!0),k(""),Va(""),La(""),te(!1),B(""),A(""),Ha(!1),la(!1),na(!1),Oe(!1),L(!0),z(0),As()},Os=async()=>{if(k(""),!sa){k("Please select an admin to transfer rights to.");return}if(!Ce){k("Password is required.");return}la(!0);try{if(!(await h(`${d}/api/auth/verify-password`,{method:"POST",body:JSON.stringify({password:Ce})})).ok){se(!1),f.error("For security reasons, you've been signed out automatically."),await fetch(`${d}/api/auth/signout`,{credentials:"include"}),g("/sign-in",{replace:!0});return}const r=await h(`${d}/api/auth/send-transfer-rights-otp`,{method:"POST",body:JSON.stringify({email:t.email})}),n=await r.json();if(!r.ok||n.success===!1){k(n.message||"Failed to send OTP");return}Ha(!0),B(""),te(!0),ls(!0),L(!1),z(30)}catch{k("Failed to verify password")}finally{la(!1)}},Rs=async()=>{if(k(""),!M||M.length!==6){k("Enter 6-digit OTP");return}try{Oe(!0);const a=await h(`${d}/api/auth/verify-otp`,{method:"POST",body:JSON.stringify({email:t.email,otp:M})}),r=await a.json();if(!a.ok||r.success===!1||r.type!=="forgotPassword"){const u=bt+1;yt(u),k(r.message||"Invalid OTP"),u>=5&&(se(!1),f.error("For security reasons, you've been signed out automatically."),await fetch(`${d}/api/auth/signout`,{credentials:"include"}),g("/sign-in",{replace:!0})),Oe(!1);return}const n=await fetch(`${d}/api/admin/transfer-rights`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({targetAdminId:sa,password:Ce})}),i=await n.json();if(!n.ok){k(i.message||"Failed to transfer rights.");return}f.success(i.message||"Admin rights transferred successfully!"),se(!1),g("/sign-in",{replace:!0})}catch{k("Failed to transfer rights.")}finally{Oe(!1)}};if(s.useEffect(()=>{y&&t&&(V({username:t.username||"",email:t.email||"",mobileNumber:t.mobileNumber?String(t.mobileNumber):"",address:t.address||"",gender:t.gender||"",avatar:t.avatar||""}),t.email&&Ct(t.email),t.mobileNumber&&At(t.mobileNumber))},[y,t]),s.useEffect(()=>{async function a(){if(t&&t._id)try{const r=await fetch(`${d}/api/user/id/${t._id}`);if(r.ok){const n=await r.json();m({type:"user/signInSuccess",payload:n})}else console.error("[fetchLatestUser] Failed to fetch user")}catch(r){console.error("[fetchLatestUser] Error:",r)}}a()},[]),!t||!t.username||!t.email)return e.jsx("div",{className:"text-center text-red-600 mt-10",children:"Profile data is missing or could not be loaded. Please refresh or sign in again."});if(J&&!y)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-100",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 mx-auto"}),e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent absolute top-0 left-1/2 transform -translate-x-1/2"}),e.jsx("div",{className:`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 ${l.pulse}`,children:e.jsx(ze,{className:"w-6 h-6 text-blue-600"})})]}),e.jsx("p",{className:`mt-4 text-gray-600 font-medium ${l.pulse}`,children:"Loading profile..."}),e.jsxs("div",{className:"flex justify-center mt-2 space-x-1",children:[e.jsx("div",{className:`w-2 h-2 bg-blue-600 rounded-full ${l.bounce} animation-delay-0`}),e.jsx("div",{className:`w-2 h-2 bg-blue-600 rounded-full ${l.bounce} animation-delay-150`}),e.jsx("div",{className:`w-2 h-2 bg-blue-600 rounded-full ${l.bounce} animation-delay-300`})]})]})});s.useEffect(()=>{y&&J&&E(!1)},[y,J]);const[Xa,_t]=s.useState(!1),[Mt,Me]=s.useState(""),Ds=async a=>{const r=a.target.files[0];if(r){if(!r.type.startsWith("image/")){Me("Please select an image file");return}if(r.size>5*1024*1024){Me("File size must be less than 5MB");return}_t(!0),Me("");try{const n=new FormData;n.append("image",r);const i=await fetch(`${d}/api/upload/image`,{method:"POST",credentials:"include",body:n}),u=await i.json();i.ok?(V(b=>({...b,avatar:u.imageUrl})),f.success("Avatar uploaded successfully!")):(Me(u.message||"Upload failed"),f.error(u.message||"Upload failed"))}catch(n){console.error("Avatar upload error:",n),Me("Upload failed. Please try again."),f.error("Upload failed. Please try again.")}finally{_t(!1)}}},[ue,xa]=s.useState({style:"avataaars",filters:{}}),zt=()=>{const a=`https://api.dicebear.com/9.x/${ue.style}/svg`,r=Object.entries(ue.filters).filter(([n,i])=>i!=null&&i!==""&&!(Array.isArray(i)&&i.length===0)).map(([n,i])=>Array.isArray(i)?`${n}=${i.join(",")}`:typeof i=="boolean"?`${n}=${i}`:`${n}=${encodeURIComponent(i)}`).join("&");return r?`${a}?${r}`:a};return e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen py-10 px-2 md:px-8",children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:`bg-white rounded-xl shadow-lg p-8 mb-6 ${_?l.fadeInUp:"opacity-0 translate-y-8"}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:space-x-6 w-full text-center sm:text-left mb-4 md:mb-0",children:[e.jsxs("div",{className:`relative flex-shrink-0 mx-auto sm:mx-0 group ${_?l.scaleIn+" animation-delay-150":"opacity-0 scale-95"}`,children:[e.jsx("div",{className:"transform transition-all duration-300 group-hover:scale-110",children:e.jsx(Vt,{user:t,size:"h-24 w-24",textSize:"text-2xl"})}),t.role==="admin"&&e.jsx("div",{className:`absolute -top-2 -right-2 bg-blue-500 text-white rounded-full p-3 shadow-xl z-20 ${l.bounceIn} animation-delay-300 ${l.float}`,children:e.jsx(fe,{className:"w-5 h-5"})}),t.isDefaultAdmin&&e.jsx("div",{className:`absolute -bottom-2 -right-2 bg-red-500 text-white rounded-full p-3 ${l.bounceIn} animation-delay-450 ${l.pulse}`,children:e.jsx(fe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:`mt-4 sm:mt-0 w-full ${_?l.fadeInLeft+" animation-delay-300":"opacity-0 -translate-x-8"}`,children:[e.jsx("div",{className:"text-center sm:text-left mb-4",children:e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 flex flex-wrap items-center justify-center sm:justify-start gap-2",children:[e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:t.username}),t.role==="admin"&&e.jsxs("span",{className:"bg-purple-100 text-purple-800 text-sm px-3 py-1 rounded-full font-medium transform transition-all duration-300 hover:scale-110 hover:bg-purple-200 flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3 text-blue-500"}),"Admin"]}),t.isDefaultAdmin&&e.jsxs("span",{className:"bg-red-100 text-red-800 text-sm px-3 py-1 rounded-full font-medium transform transition-all duration-300 hover:scale-110 hover:bg-red-200 animate-pulse flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3 text-red-500"}),"Default Admin"]}),t.role==="user"&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full font-medium transform transition-all duration-300 hover:scale-110 hover:bg-blue-200",children:"User"})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 hover:border-blue-300 transition-all duration-300 hover:shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ht,{className:"w-4 h-4 mr-3 text-blue-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-700 text-sm break-all",children:t.email})]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 hover:border-green-300 transition-all duration-300 hover:shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"w-4 h-4 mr-3 text-green-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium mb-1",children:"Mobile"}),e.jsxs("p",{className:"text-gray-700 text-sm",children:[t.mobileNumber&&t.mobileNumber!=="0000000000"?`+91 ${t.mobileNumber.slice(0,5)} ${t.mobileNumber.slice(5)}`:"Not provided",t.isGeneratedMobile&&e.jsx("span",{className:"text-xs text-gray-400 block",children:"(Generated for Google signup)"})]})]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 hover:border-purple-300 transition-all duration-300 hover:shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ze,{className:"w-4 h-4 mr-3 text-purple-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium mb-1",children:"Gender"}),e.jsx("p",{className:"text-gray-700 text-sm capitalize",children:t.gender||"Not provided"})]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 hover:border-blue-300 transition-all duration-300 hover:shadow-md",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ba,{className:"w-4 h-4 mr-3 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium mb-1",children:"Address"}),e.jsx("p",{className:"text-gray-700 text-sm break-words",children:t.address||"Not provided"})]})]})})]}),(!t.gender||!t.address||!t.mobileNumber)&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-3",children:e.jsx("p",{className:"text-sm text-amber-700 font-medium text-center sm:text-left",children:"⚠️ Complete your profile for better experience"})}),e.jsx("div",{className:"text-center sm:text-left",children:e.jsxs("p",{className:"text-sm text-gray-500 transition-all duration-300 hover:text-gray-700",children:[e.jsx(et,{className:"w-3 h-3 inline mr-1"}),"Member since ",Cs(t.createdAt)]})})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:()=>ka(!y),className:`bg-gradient-to-r from-blue-500 to-purple-500 text-white px-5 sm:px-4 py-4 sm:py-2 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 hover:rotate-1 shadow-lg font-semibold flex items-center gap-2 sm:gap-2 text-base sm:text-sm w-full sm:w-auto justify-center group ${_?l.fadeInRight+" animation-delay-450":"opacity-0 translate-x-8"}`,children:[e.jsx(he,{className:`w-5 h-5 transition-transform duration-300 ${y?"rotate-180":""} group-hover:${l.wiggle}`}),y?"Cancel Edit":"Edit Profile"]})})]})}),y&&e.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-8 mb-6 ${l.slideInUp}`,children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center group",children:[e.jsx(he,{className:`w-5 h-5 mr-2 text-blue-600 transition-transform duration-300 group-hover:${l.wiggle}`}),e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Edit Profile Information"})]}),e.jsxs("form",{onSubmit:xs,className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"mb-2",children:e.jsx(Vt,{user:{...t,avatar:o.avatar},size:"w-24 h-24",textSize:"text-2xl"})}),y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center mt-2",children:[st.map((a,r)=>e.jsx("button",{type:"button",onClick:()=>V({...o,avatar:a}),className:`w-12 h-12 rounded-full border-2 transition-all duration-300 transform hover:scale-110 hover:shadow-lg ${o.avatar===a?"border-blue-500 shadow-lg scale-105":"border-gray-300 hover:border-blue-400"} focus:outline-none focus:ring-2 focus:ring-blue-400 ${l.bounceIn} animation-delay-${r*50}`,children:e.jsx("img",{src:a,alt:`Avatar ${r+1}`,className:"w-full h-full rounded-full object-cover transition-all duration-300 hover:brightness-110"})},a)),e.jsxs("label",{className:`w-12 h-12 rounded-full border-2 border-gray-300 flex items-center justify-center cursor-pointer bg-gray-100 hover:bg-gray-200 transition-all duration-300 transform hover:scale-110 hover:shadow-lg hover:border-blue-400 group ${l.bounceIn} animation-delay-${st.length*50} ${Xa?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:Ds,disabled:Xa}),Xa?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full"}):e.jsx(he,{className:`text-gray-500 group-hover:text-blue-500 transition-colors duration-300 group-hover:${l.wiggle}`,title:"Upload custom avatar"})]}),e.jsx("button",{type:"button",onClick:()=>V({...o,avatar:""}),className:`w-12 h-12 rounded-full border-2 border-red-400 flex items-center justify-center bg-red-50 hover:bg-red-100 transition-all duration-300 transform hover:scale-110 hover:shadow-lg hover:border-red-500 group ${l.bounceIn} animation-delay-${(st.length+1)*50}`,children:e.jsx(Jt,{className:`text-red-500 group-hover:text-red-600 transition-colors duration-300 group-hover:${l.wiggle}`})})]}),e.jsxs("div",{className:"mt-4 w-full flex flex-col items-center",children:[e.jsx("div",{className:"font-semibold text-gray-700 mb-2",children:"Or create a custom DiceBear avatar:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-center w-full",children:[e.jsx("label",{className:"font-medium text-sm",children:"Style:"}),e.jsx("select",{className:"border p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",value:ue.style,onChange:a=>{xa({style:a.target.value,filters:{}})},children:qs.map(a=>e.jsx("option",{value:a.key,children:a.label},a.key))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2 w-full max-w-2xl",children:[Gs.map(a=>!ja.properties[a]||a==="style"?null:a==="seed"?e.jsxs("div",{className:"flex flex-col mb-2",children:[e.jsx("label",{className:"text-xs font-medium mb-1",children:a}),e.jsx("input",{type:"text",className:"border p-2 rounded-lg",value:ue.filters[a]||"",onChange:n=>xa(i=>({...i,filters:{...i.filters,[a]:n.target.value}})),placeholder:"Enter a name or keyword (e.g. John, robot, flower...)"})]},a):null),e.jsxs("div",{className:"flex items-end gap-6 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs font-medium",children:"flip"}),e.jsx("input",{type:"checkbox",checked:!!ue.filters.flip,onChange:a=>xa(r=>({...r,filters:{...r.filters,flip:a.target.checked}}))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-medium mb-1",children:"rotate"}),e.jsx("input",{type:"number",className:"border p-2 rounded-lg w-24",value:ue.filters.rotate??ja.properties.rotate.default??"",min:ja.properties.rotate.minimum,max:ja.properties.rotate.maximum,onChange:a=>xa(r=>({...r,filters:{...r.filters,rotate:a.target.value===""?void 0:Number(a.target.value)}}))})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[e.jsx("img",{src:zt(),alt:"DiceBear Avatar Preview",className:"w-24 h-24 rounded-full border-2 border-blue-300 shadow"}),e.jsx("button",{type:"button",className:"mt-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 py-2 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all font-semibold",onClick:async()=>{const a=zt();V({...o,avatar:a});try{const n=await(await fetch(`${d}/api/user/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({avatar:a})})).json();n.status==="success"?f.success("Avatar updated!"):n.status==="error"&&f.error(n.message||"Failed to update avatar.")}catch{f.error("Failed to update avatar.")}},children:"Use this avatar"})]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"Note: Please upload a profile image below 5MB for best performance."}),Mt&&e.jsx("div",{className:"text-red-500 text-sm mt-2 text-center bg-red-50 p-2 rounded-lg border border-red-200",children:Mt})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(ze,{className:"w-4 h-4 mr-2"}),"Username"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"username",placeholder:"Enter username",value:o.username||"",onChange:_e,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all pr-12"}),o.username&&o.username.trim()&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-600 z-20",children:e.jsx(C,{className:"text-xl"})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Email Address"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",id:"email",placeholder:"Enter email address",value:o.email||"",onChange:_e,readOnly:!v||v&&F||q,disabled:q,className:`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ${!v||v&&F||q?"bg-gray-100 cursor-not-allowed border-green-500 pr-20":c.available===!1?"border-red-500 focus:ring-red-500 pr-12":c.available===!0?"border-green-500 focus:ring-green-500 pr-12":"border-gray-300 focus:ring-blue-500 pr-12"}`}),c.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}),c.available===!0&&!c.loading&&!$&&o.email!==j&&(v||F)&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-600 z-20",children:e.jsx(C,{className:"text-xl"})}),c.available===!0&&!c.loading&&o.email===j&&!v&&e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2 z-20",children:[e.jsx("button",{type:"button",onClick:()=>ma(!0),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Edit email",children:e.jsx(he,{className:"text-sm"})}),e.jsx("div",{className:"text-green-600",children:e.jsx(C,{className:"text-xl"})})]}),c.available===!0&&!c.loading&&o.email===j&&v&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-600 z-20",children:e.jsx(C,{className:"text-xl"})}),c.available===!0&&!c.loading&&!$&&o.email!==j&&F&&e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2 z-20",children:[e.jsx("button",{type:"button",onClick:()=>{ma(!0),T(!1),I(!1)},className:"text-blue-600 hover:text-blue-800 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Edit email",children:e.jsx(he,{className:"text-sm"})}),e.jsx("div",{className:"text-blue-600",children:e.jsx(C,{className:"text-xl"})})]}),c.available===!0&&!c.loading&&!F&&!$&&o.email!==j&&v&&e.jsx("button",{type:"button",onClick:Dt,disabled:q||!Pt||!o.email||Ue&&!Fe,className:"absolute right-16 top-1/2 transform -translate-y-1/2 px-3 py-1 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap z-10",children:q?"Sending...":"Send OTP"}),$&&o.email!==j&&!v&&!c.loading&&e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2 z-20",children:[e.jsx("button",{type:"button",onClick:()=>ma(!0),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Edit email",children:e.jsx(he,{className:"text-sm"})}),e.jsx("div",{className:"text-green-600",children:e.jsx(C,{className:"text-xl"})})]}),$&&o.email!==j&&v&&!c.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 z-20",children:e.jsx("div",{className:"text-green-600",children:e.jsx(C,{className:"text-xl"})})}),c.available===!1&&!c.loading&&v&&!F&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 z-20",children:e.jsx(ya,{className:"h-5 w-5 text-red-500"})})]}),$t&&c.available===!0&&!c.loading&&!F&&!$&&o.email!==j&&v&&e.jsxs("div",{className:"mt-3",children:[e.jsx(Qt,{ref:ha,onVerify:Et,onExpire:Ot,onError:Rt,className:"flex justify-center"},Tt),fa&&e.jsx("p",{className:"text-red-500 text-sm mt-2 text-center",children:fa})]}),ca&&!F&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:ca}),F&&!$&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["OTP sent to ",o.email]}),F&&!$&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("input",{ref:Ya,type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter 6-digit OTP",id:"otp",value:oe,disabled:de,onChange:a=>{const r=a.target.value.replace(/[^0-9]/g,"");U(r)},onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),oe&&oe.length===6&&!de&&It())},className:`flex-1 px-3 py-2 sm:px-4 sm:py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm sm:text-base ${de?"bg-gray-100 cursor-not-allowed":""}`,maxLength:"6"}),e.jsx("button",{type:"button",onClick:It,disabled:de||oe.length!==6,className:"px-3 py-2 sm:px-4 sm:py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 text-sm sm:text-base whitespace-nowrap",children:de?"Verifying...":"Verify"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Enter the 6-digit code sent to your email"}),e.jsx("div",{className:"flex items-center gap-2",children:Ie>0?e.jsxs("span",{className:"text-xs text-gray-500",children:["Resend in ",Math.floor(Ie/60),":",(Ie%60).toString().padStart(2,"0")]}):e.jsx("button",{type:"button",onClick:Dt,disabled:q||de||Ue&&!Fe,className:"text-xs text-blue-600 hover:text-blue-800 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:q?"Sending...":"Resend OTP"})})]}),$t&&c.available===!0&&!c.loading&&o.email!==j&&v&&e.jsxs("div",{className:"mt-3",children:[e.jsx(Qt,{ref:ha,onVerify:Et,onExpire:Ot,onError:Rt,className:"flex justify-center"},Tt),fa&&e.jsx("p",{className:"text-red-500 text-sm mt-2 text-center",children:fa})]}),ca&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:ca})]}),oa&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:oa}),c.message&&!oa&&e.jsx("div",{className:`text-sm mt-1 ${c.available===!0?"text-green-600":c.available===!1?"text-red-600":"text-gray-600"}`,children:c.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(Bt,{className:"w-4 h-4 mr-2"}),"Mobile Number"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"tel",id:"mobileNumber",placeholder:"Enter 10-digit mobile number",value:o.mobileNumber||"",onChange:_e,pattern:"[0-9]{10}",maxLength:"10",className:`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ${p.available===!1?"border-red-500 focus:ring-red-500":p.available===!0?"border-green-500 focus:ring-green-500":"border-gray-300 focus:ring-blue-500"}`}),p.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}),p.available===!0&&!p.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(C,{className:"h-5 w-5 text-green-500"})}),p.available===!1&&!p.loading&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(ya,{className:"h-5 w-5 text-red-500"})})]}),da&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:da}),p.message&&!da&&e.jsx("div",{className:`text-sm mt-1 ${p.available===!0?"text-green-600":p.available===!1?"text-red-600":"text-gray-600"}`,children:p.message})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(ze,{className:"w-4 h-4 mr-2"}),"Gender"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"gender",value:o.gender||"",onChange:_e,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all pr-12",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]}),o.gender&&o.gender.trim()&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-600 z-20",children:e.jsx(C,{className:"text-xl"})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(ba,{className:"w-4 h-4 mr-2"}),"Address"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"address",placeholder:"Enter your address",value:o.address||"",onChange:_e,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all pr-12"}),o.address&&o.address.trim()&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-600 z-20",children:e.jsx(C,{className:"text-xl"})})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{ka(!1),I(!1),T(!1),U(""),P(""),qa(0),Ga(!0)},className:"bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-3 rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2",children:"Cancel"}),e.jsx("button",{type:"submit",className:`bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg font-semibold flex items-center gap-2 ${J||c.loading||p.loading||c.available===!1||p.available===!1||o.email!==j&&!$?"opacity-60 cursor-not-allowed transform-none":""}`,disabled:J||c.loading||p.loading||c.available===!1||p.available===!1||o.email!==j&&!$,children:J?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Saving..."]}):"Save Changes"})]}),K&&!oa&&!da&&e.jsx("div",{className:"text-red-600 text-sm mt-3",children:K})]})]}),!y&&Sa&&e.jsx("div",{className:"text-green-600 text-sm mb-6",children:"Profile updated successfully!"}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 ${pa?"lg:grid-cols-3":"lg:grid-cols-4"} gap-4 mb-6`,children:[e.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-4 text-center group hover:shadow-2xl transition-all duration-500 hover:scale-105 hover:-translate-y-2 ${_?l.scaleIn+" animation-delay-450":"opacity-0 scale-95"}`,children:[e.jsx("div",{className:`bg-blue-100 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-200 transition-all duration-300 ${l.float} group-hover:scale-110`,children:e.jsx(ba,{className:"w-5 h-5 text-blue-600 group-hover:text-blue-700 transition-colors duration-300"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-blue-600 transition-colors duration-300",children:ga?e.jsx(wa,{end:w.listings,delay:500}):w.listings}),e.jsx("p",{className:"text-sm text-gray-600 group-hover:text-blue-500 transition-colors duration-300",children:"My Listings"})]}),e.jsxs("div",{className:`bg-white rounded-xl shadow-lg ${pa?"p-6":"p-4"} text-center group hover:shadow-2xl transition-all duration-500 hover:scale-105 hover:-translate-y-2 ${_?l.scaleIn+" animation-delay-600":"opacity-0 scale-95"}`,children:[e.jsx("div",{className:`bg-green-100 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-green-200 transition-all duration-300 ${l.float} group-hover:scale-110`,children:e.jsx(et,{className:"w-5 h-5 text-green-600 group-hover:text-green-700 transition-colors duration-300"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-green-600 transition-colors duration-300",children:ga?e.jsx(wa,{end:w.appointments,delay:650}):w.appointments}),e.jsx("p",{className:"text-sm text-gray-600 group-hover:text-green-500 transition-colors duration-300",children:"Appointments"})]}),e.jsxs("div",{className:`bg-white rounded-xl shadow-lg ${pa?"p-6":"p-4"} text-center group hover:shadow-2xl transition-all duration-500 hover:scale-105 hover:-translate-y-2 ${_?l.scaleIn+" animation-delay-750":"opacity-0 scale-95"}`,children:[e.jsx("div",{className:`bg-red-100 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-red-200 transition-all duration-300 ${l.heartbeat} group-hover:scale-110`,children:e.jsx(Wt,{className:"w-5 h-5 text-red-600 group-hover:text-red-700 transition-colors duration-300"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-red-600 transition-colors duration-300",children:ga?e.jsx(wa,{end:w.wishlist,delay:800}):w.wishlist}),e.jsx("p",{className:"text-sm text-gray-600 group-hover:text-red-500 transition-colors duration-300",children:"Wishlist Items"})]}),!pa&&e.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-4 text-center group hover:shadow-2xl transition-all duration-500 hover:scale-105 hover:-translate-y-2 ${_?l.scaleIn+" animation-delay-900":"opacity-0 scale-95"}`,children:[e.jsx("div",{className:`bg-purple-100 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-purple-200 transition-all duration-300 ${l.float} group-hover:scale-110`,children:e.jsx(Yt,{className:"w-5 h-5 text-purple-600 group-hover:text-purple-700 transition-colors duration-300"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-purple-600 transition-colors duration-300",children:ga?e.jsx(wa,{end:w.watchlist,delay:950}):w.watchlist}),e.jsx("p",{className:"text-sm text-gray-600 group-hover:text-purple-500 transition-colors duration-300",children:"Watchlist Items"})]})]}),e.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-8 mb-6 ${_?l.fadeInUp+" animation-delay-300":"opacity-0 translate-y-8"}`,children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Quick Actions"})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3",children:[e.jsxs("button",{onClick:Ts,className:`bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition-all duration-300 transform hover:scale-110 hover:-translate-y-1 hover:shadow-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500 flex flex-col items-center group ${l.bounceIn} animation-delay-450`,children:[e.jsx(ba,{className:"w-4 h-4 mb-1 transition-transform duration-300 group-hover:-translate-y-0.5"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"My Listings"})]}),e.jsxs(x,{to:t.role==="admin"||t.role==="rootadmin"?"/admin/appointments":"/user/my-appointments",className:`bg-green-500 text-white p-3 rounded-lg hover:bg-green-600 transition-all duration-300 transform hover:scale-110 hover:-translate-y-1 hover:shadow-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500 flex flex-col items-center group ${l.bounceIn} animation-delay-600`,children:[e.jsx(et,{className:"w-4 h-4 mb-1 transition-transform duration-300 group-hover:-translate-y-0.5"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:t.role==="admin"||t.role==="rootadmin"?"Appointments":"My Appointments"})]}),!(t.role==="admin"||t.role==="rootadmin")&&e.jsxs(x,{to:"/user/wishlist",className:`bg-red-500 text-white p-3 rounded-lg hover:bg-red-600 transition-all duration-300 transform hover:scale-110 hover:-translate-y-1 hover:shadow-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-red-500 flex flex-col items-center group ${l.bounceIn} animation-delay-750`,children:[e.jsx(Wt,{className:"w-4 h-4 mb-1 transition-transform duration-300 group-hover:scale-110"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"My Wishlist"})]}),!(t.role==="admin"||t.role==="rootadmin")&&e.jsxs(x,{to:"/user/watchlist",className:`bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition-all duration-300 transform hover:scale-110 hover:-translate-y-1 hover:shadow-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500 flex flex-col items-center group ${l.bounceIn} animation-delay-800`,children:[e.jsx(Yt,{className:"w-4 h-4 mb-1 transition-transform duration-300 group-hover:-translate-y-0.5"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"My Watchlist"})]}),e.jsxs(x,{to:t.role==="admin"||t.role==="rootadmin"?"/admin/reviews":"/user/reviews",className:`bg-yellow-500 text-white p-3 rounded-lg hover:bg-yellow-600 transition-all duration-300 transform hover:scale-110 hover:-translate-y-1 hover:shadow-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-yellow-500 flex flex-col items-center group ${l.bounceIn} animation-delay-900`,children:[e.jsx(Ms,{className:"w-4 h-4 mb-1 transition-transform duration-300 group-hover:scale-110"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:t.role==="admin"||t.role==="rootadmin"?"Reviews":"My Reviews"})]}),t.role==="admin"||t.role==="rootadmin"?e.jsxs(e.Fragment,{children:[e.jsxs(x,{to:"/admin/payments",className:`bg-emerald-500 text-white p-3 rounded-lg hover:bg-emerald-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-900`,children:[e.jsx(qt,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Payments"})]}),e.jsxs(x,{to:"/admin/fraudmanagement",className:`bg-rose-500 text-white p-3 rounded-lg hover:bg-rose-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-1050`,children:[e.jsx(Gt,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Fraud Mgmt"})]}),e.jsxs(x,{to:"/admin/services",className:`bg-indigo-500 text-white p-3 rounded-lg hover:bg-indigo-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-1100`,children:[e.jsx(at,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Services"})]}),e.jsxs(x,{to:"/admin/route-planner",className:`bg-purple-500 text-white p-3 rounded-lg hover:bg-purple-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-1200`,children:[e.jsx(Zt,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Route Planner"})]}),e.jsxs(x,{to:"/admin/security-moderation",className:`bg-indigo-500 text-white p-3 rounded-lg hover:bg-indigo-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-1250`,children:[e.jsx(Kt,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Security Moderation"})]})]}):null,!(t.role==="admin"||t.role==="rootadmin")&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{to:"/user/services",className:`bg-indigo-500 text-white p-3 rounded-lg hover:bg-indigo-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-950`,children:[e.jsx(at,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Services"})]}),e.jsxs(x,{to:"/user/route-planner",className:`bg-purple-500 text-white p-3 rounded-lg hover:bg-purple-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-1050`,children:[e.jsx(Zt,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Route Planner"})]}),e.jsxs(x,{to:"/user/my-payments",className:`bg-emerald-500 text-white p-3 rounded-lg hover:bg-emerald-600 transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 hover:shadow-lg flex flex-col items-center group ${l.bounceIn} animation-delay-900`,children:[e.jsx(qt,{className:`w-4 h-4 mb-1 transition-transform duration-300 group-hover:${l.bounce}`}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"My Payments"})]})]})]})]}),e.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-8 ${_?l.fadeInUp+" animation-delay-600":"opacity-0 translate-y-8"}`,children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Account Management"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>g(t.role==="admin"||t.role==="rootadmin"?"/admin/change-password":"/user/change-password"),className:`w-full bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-750`,children:[e.jsx(zs,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.wiggle}`}),"Change Password"]}),e.jsxs("button",{onClick:()=>g(t.role==="admin"||t.role==="rootadmin"?"/admin/device-management":"/user/device-management"),className:`w-full bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-900`,children:[e.jsx(Kt,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.wiggle}`}),e.jsx("span",{className:"group-hover:animate-pulse",children:"Device Management"})]}),(t.role==="admin"||t.role==="rootadmin")&&e.jsxs("button",{onClick:()=>g("/admin/management"),className:`w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-1050`,children:[e.jsx(ze,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.wiggle}`}),e.jsx("span",{className:"group-hover:animate-pulse",children:"Accounts"})]}),(t.role==="admin"||t.role==="rootadmin")&&e.jsxs("button",{onClick:()=>g("/admin/session-management"),className:`w-full bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-1200`,children:[e.jsx(at,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.wiggle}`}),e.jsx("span",{className:"group-hover:animate-pulse",children:"Session Management"})]}),t.role==="rootadmin"&&e.jsxs("button",{onClick:()=>g("/admin/session-audit-logs"),className:`w-full bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-1350`,children:[e.jsx(Gt,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.wiggle}`}),e.jsx("span",{className:"group-hover:animate-pulse",children:"Audit Logs"})]}),t.isDefaultAdmin&&e.jsxs("button",{onClick:Es,className:`w-full bg-yellow-500 text-white px-6 py-3 rounded-lg hover:bg-yellow-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-1500`,children:[e.jsx(fe,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.bounce} text-yellow-200`}),"Transfer Rights"]}),t.isDefaultAdmin&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4 text-blue-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-2",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Note:"})," You must transfer your default admin rights to another admin before you can delete your account."]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:$s,className:`bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-1650`,children:[e.jsx(Ls,{className:"w-4 h-4 mr-2 transition-transform duration-300 group-hover:-translate-x-1"}),"Sign Out"]}),e.jsxs("button",{onClick:bs,className:`bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center justify-center font-semibold group ${l.slideInUp} animation-delay-1800`,children:[e.jsx(Jt,{className:`w-4 h-4 mr-2 transition-transform duration-300 group-hover:${l.wiggle}`}),"Delete Account"]})]})]})]})]}),be&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-[fadeIn_0.3s_ease-out]",children:e.jsx("div",{className:`bg-white rounded-xl shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto ${l.scaleIn}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Transfer Default Admin Rights"}),e.jsx("button",{onClick:()=>{Ye(""),Je(!1)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(ya,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"As the default admin, you must select another approved admin to transfer your default admin rights before deleting your account."}),lt?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):rt.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500",children:"No other approved admins found."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You cannot delete your account until another admin is approved."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin to Transfer Rights To:"}),e.jsxs("select",{value:We,onChange:a=>Ye(a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose an admin..."}),rt.map(a=>e.jsxs("option",{value:a._id,children:[a.username," (",a.email,")"]},a._id))]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{Ye(""),Je(!1)},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Ss,disabled:!We||Q,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:Q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Transfer & Delete"]})})]})]})})}),Ca&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-[fadeIn_0.3s_ease-out]",children:e.jsx("div",{className:`bg-white rounded-xl shadow-xl max-w-md w-full ${l.scaleIn}`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Account Deletion"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Enter your password. After verification, we will email you an OTP to complete deletion."}),e.jsxs("form",{onSubmit:async a=>{a.preventDefault(),!W&&!Xe?await ys():!W&&Xe?await vs():await ws()},children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password:"}),e.jsx("input",{type:"password",className:`w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500 ${ft||Qe?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Enter your password",value:Ze,onChange:a=>nt(a.target.value),disabled:ft||Qe}),it&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:it}),Xe&&!W&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for leaving"}),e.jsxs("select",{className:`w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500 ${ee?"bg-gray-100 cursor-not-allowed":""}`,value:je,onChange:a=>ct(a.target.value),disabled:ee,children:[e.jsx("option",{value:"",children:"Select a reason"}),e.jsx("option",{value:"Better platform",children:"Found a better platform"}),e.jsx("option",{value:"Privacy or security concerns",children:"Privacy or security concerns"}),e.jsx("option",{value:"Too many notifications/emails",children:"Too many notifications/emails"}),e.jsx("option",{value:"Couldn't find suitable property",children:"Couldn't find suitable property"}),e.jsx("option",{value:"Just testing / trial account",children:"Just testing / trial account"}),e.jsx("option",{value:"other",children:"Other (please specify)"})]}),je==="other"&&e.jsx("input",{type:"text",className:`w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500 ${ee?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Please describe your reason (optional)",value:mt,onChange:a=>ut(a.target.value),disabled:ee})]}),W&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("input",{ref:Pa,type:"text",maxLength:"6",value:Ke,onChange:a=>Aa(a.target.value.replace(/[^0-9]/g,"")),className:`flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 ${Se||we?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"6-digit OTP",disabled:Se||we}),e.jsx("button",{type:"button",disabled:ss||!rs||H>0||Se||we,onClick:async()=>{if(H>0)return;Y(""),await js()&&(Ra(!1),Oa(30))},className:"px-4 py-2 bg-gray-100 rounded-lg text-sm disabled:opacity-50 sm:self-auto self-start",children:Se?"Sending...":H>0?`Resend in ${H}s`:"Resend OTP"})]}),ot&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:ot}),e.jsxs("div",{className:"text-green-600 text-sm mt-2 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"OTP has been sent to your email address"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{ye(!1),nt(""),ve(""),dt(!1),ct(""),ut(""),Ea(!1),Aa(""),Y(""),ht(!1),ea(!1),Da(!1),Ne(!1),Ia(!1)},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:Qe||ee||we||Se,children:W?we?"Deleting...":"Delete":Xe?ee?"Processing...":"Continue":Qe?"Verifying...":"Verify"})]})]})]})})}),Fa&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-[fadeIn_0.3s_ease-out]",children:e.jsx("div",{className:`bg-white rounded-xl shadow-xl max-w-md w-full ${l.scaleIn}`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Account Deletion"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm account deletion after transferring default admin rights. This action cannot be undone."}),e.jsxs("form",{onSubmit:async a=>{a.preventDefault(),N?await Ps():await ks()},children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password:"}),e.jsx("input",{type:"password",className:`w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-red-500 ${pt||Q?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Enter your password",value:aa,onChange:a=>Ua(a.target.value),disabled:pt||Q}),gt&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:gt}),N&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:$a,type:"text",maxLength:"6",value:M,onChange:a=>B(a.target.value.replace(/[^0-9]/g,"")),className:`flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 ${Pe||$e?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"6-digit OTP",disabled:Pe||$e}),e.jsx("button",{type:"button",disabled:!vt||S>0||Pe||$e,onClick:async()=>{if(S>0)return;await Ut()&&(L(!1),z(30))},className:"px-3 py-2 bg-gray-100 rounded-lg text-sm disabled:opacity-50",children:Pe?"Sending...":S>0?`Resend in ${S}s`:"Resend OTP"})]}),xt&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:xt}),e.jsxs("div",{className:"text-green-600 text-sm mt-2 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"OTP has been sent to your email address"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{ke(!1),Ua(""),ae(""),te(!1),B(""),A(""),_a(!1),Ge(!1),ta(!1),Te(!1),L(!0),z(0)},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:Q||Pe||$e,children:$e?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Deleting..."]}):N?"Transfer & Delete":Q?"Processing...":"Verify & Send OTP"})]})]})]})})}),ns&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-[fadeIn_0.3s_ease-out]",children:e.jsx("div",{className:`bg-white rounded-xl shadow-xl max-w-md w-full ${l.scaleIn}`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Profile Update"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Please enter your password to confirm the profile changes."}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password",value:Ba,onChange:a=>R(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),Ft())}}),wt&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:wt}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{O(!1),R(""),Ja("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Ft,disabled:J,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:J?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Profile"})]})]})})}),Ma&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-[fadeIn_0.3s_ease-out]",children:e.jsx("div",{className:`bg-white rounded-xl shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto ${l.scaleIn}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Transfer Root Admin Rights"}),e.jsx("button",{onClick:()=>se(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ya,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Select an admin to transfer your root admin rights. You will remain an admin after transfer."}),lt?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):jt.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500",children:"No other admins found."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You cannot transfer rights until another admin exists."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin to Transfer Rights To:"}),e.jsxs("select",{value:sa,onChange:a=>La(a.target.value),className:`w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${ia||re?"bg-gray-100 cursor-not-allowed":""}`,disabled:ia||re,children:[e.jsx("option",{value:"",children:"Choose an admin..."}),jt.map(a=>e.jsxs("option",{value:a._id,children:[a.username," (",a.email,")"]},a._id))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password:"}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),N?Rs():Os()},children:[e.jsx("input",{type:"password",className:`w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 ${ia||re?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Enter your password",value:Ce,onChange:a=>Va(a.target.value),disabled:ia||re}),!N&&ra&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:ra}),N&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:Ta,type:"text",maxLength:"6",value:M,onChange:a=>B(a.target.value.replace(/[^0-9]/g,"")),className:`flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 ${Ae||Ee?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"6-digit OTP",disabled:Ae||Ee}),e.jsx("button",{type:"button",disabled:!vt||S>0||Ae||Ee,onClick:async()=>{if(S>0)return;await Ut()&&(L(!1),z(30))},className:"px-3 py-2 bg-gray-100 rounded-lg text-sm disabled:opacity-50",children:Ae?"Sending...":S>0?`Resend in ${S}s`:"Resend OTP"})]}),ra&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:ra}),e.jsxs("div",{className:"text-green-600 text-sm mt-2 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"OTP has been sent to your email address"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{se(!1),La(""),Va(""),k(""),te(!1),B(""),A(""),Ha(!1),la(!1),na(!1),Oe(!1),L(!0),z(0)},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!sa||!Ce||re||Ae||Ee||N&&M.length!==6,className:"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:Ee?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Transferring..."]}):re?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),N?"Transfer Rights":"Verify"]})})]})]})]})]})})}),e.jsx(Vs,{}),e.jsx("div",{className:"mt-8 flex flex-col items-center space-y-2 text-sm text-gray-600",children:t&&(t.role==="admin"||t.role==="rootadmin")?e.jsxs(e.Fragment,{children:[e.jsx(x,{to:"/admin/terms",className:"text-blue-600 hover:underline",children:"Admin Terms & Conditions"}),e.jsx(x,{to:"/admin/privacy",className:"text-blue-600 hover:underline",children:"Admin Privacy Policy"})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{to:"/user/terms",className:"text-blue-600 hover:underline",children:"User Terms & Conditions"}),e.jsx(x,{to:"/user/privacy",className:"text-blue-600 hover:underline",children:"User Privacy Policy"})]})})]})}export{ar as default};
