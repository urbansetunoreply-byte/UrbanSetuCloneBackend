import{u as Ce,r as i,j as e,p as ee,aM as se,_ as te,y as ae,aN as ke,aq as Ie,aO as Le,T as re,aB as A,M as le,aP as _e,V as Te,L as De,aQ as ne,af as ie,a0 as Fe,aL as Re,K as $e,H as h}from"./index-WPqAAPOK.js";import{L as Ee}from"./ListingItem-BRW1pCqo.js";import"./addressMasking-3vIUwCOC.js";const u="https://urbansetu.onrender.com";function Ve(){const{currentUser:d}=Ce(s=>s.user),[c,N]=i.useState([]),[C,M]=i.useState([]),[k,W]=i.useState(new Map),[ce,B]=i.useState(!0),[v,oe]=i.useState(""),[V,de]=i.useState("dateAdded"),[I,xe]=i.useState("all"),[O,z]=i.useState(!1),[w,H]=i.useState(""),[U,q]=i.useState([]),[K,Y]=i.useState(!1),[L,S]=i.useState([]),[me,f]=i.useState(!1),[_,G]=i.useState(!1),[m,b]=i.useState([]),[P,T]=i.useState(!1),[j,J]=i.useState("grid"),[D,he]=i.useState(!1),[p,Z]=i.useState({totalValue:0,averagePrice:0,priceRange:{min:0,max:0},typeDistribution:{},cityDistribution:{}}),F=async(s=!0)=>{if(d!=null&&d._id){s&&B(!0);try{const t=await fetch(`${u}/api/watchlist/user/${d._id}`,{credentials:"include"});if(t.ok){const r=await t.json();M(r);const l=r.filter(a=>a.listingId).map(a=>a.listingId);N(l);const n=new Map;r.forEach(a=>{a.listingId&&a.effectivePriceAtAdd!=null&&n.set(a.listingId._id,a.effectivePriceAtAdd)}),W(n)}}catch{}finally{s&&B(!1)}}},R=s=>s?(s.offer&&s.discountPrice?s.discountPrice:s.regularPrice)??null:null,pe=()=>{if(c.length===0){Z({totalValue:0,averagePrice:0,priceRange:{min:0,max:0},typeDistribution:{},cityDistribution:{}});return}const s=c.map(o=>o.regularPrice||0).filter(o=>o>0),t=s.reduce((o,x)=>o+x,0),r=s.length>0?t/s.length:0,l={min:s.length>0?Math.min(...s):0,max:s.length>0?Math.max(...s):0},n=c.reduce((o,x)=>(o[x.type]=(o[x.type]||0)+1,o),{}),a=c.reduce((o,x)=>{const y=x.city||"Unknown";return o[y]=(o[y]||0)+1,o},{});Z({totalValue:t,averagePrice:r,priceRange:l,typeDistribution:n,cityDistribution:a})};i.useEffect(()=>{F()},[d==null?void 0:d._id]),i.useEffect(()=>{if(!(d!=null&&d._id)||c.length===0)return;const s=setInterval(()=>{F(!1)},5*60*1e3);return()=>clearInterval(s)},[d==null?void 0:d._id,c.length]),i.useEffect(()=>{const s=()=>{!document.hidden&&(d!=null&&d._id)&&c.length>0&&F(!1)};return document.addEventListener("visibilitychange",s),()=>{document.removeEventListener("visibilitychange",s)}},[d==null?void 0:d._id,c.length]),i.useEffect(()=>{pe()},[c]);const Q=async s=>{try{(await fetch(`${u}/api/watchlist/remove/${s}`,{method:"DELETE",credentials:"include"})).ok&&(N(r=>r.filter(l=>l._id!==s)),M(r=>r.filter(l=>{var n;return(((n=l.listingId)==null?void 0:n._id)||l.listingIdRaw)!==s})),h.success("Removed from watchlist"))}catch{}},$=async(s=w)=>{const t=typeof s=="string"?s.trim():"";if(t){Y(!0);try{const r=await fetch(`${u}/api/listing/get?search=${encodeURIComponent(t)}&limit=20`,{credentials:"include"});if(r.ok){const l=await r.json();q(l),S(l.slice(0,5))}}catch(r){console.error("Error searching properties:",r),h.error("Failed to search properties")}finally{Y(!1)}}},ge=async s=>{const t=typeof s=="string"?s.trim():"";if(!t||t.length<2){S([]),f(!1);return}G(!0);try{const r=await fetch(`${u}/api/listing/get?search=${encodeURIComponent(t)}&limit=5`,{credentials:"include"});if(r.ok){const l=await r.json();S(l),f(!0)}}catch(r){console.error("Error fetching suggestions:",r)}finally{G(!1)}},ue=s=>{const t=s.target.value;H(t),ge(t)},fe=s=>{H(s.name),f(!1),S([]),$(s.name)},be=async s=>{var t,r;try{const l=await fetch(`${u}/api/watchlist/add`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({listingId:s._id})});if(l.ok){const n=await l.json();N(o=>[s,...o]),q(o=>o.filter(x=>x._id!==s._id));const a=((t=n==null?void 0:n.item)==null?void 0:t.effectivePriceAtAdd)??((r=n==null?void 0:n.wishlistItem)==null?void 0:r.effectivePriceAtAdd)??null;a!=null&&W(o=>new Map(o).set(s._id,a)),h.success("Added to watchlist")}else{const n=await l.json();h.error(n.message||"Failed to add to watchlist")}}catch(l){console.error("Error adding to watchlist:",l),h.error("Failed to add to watchlist")}},E=s=>c.some(t=>t._id===s),je=s=>{b(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s])},ye=()=>{m.length===g.length?b([]):b(g.map(s=>s._id))},Ne=async()=>{if(m.length!==0)try{const s=m.map(t=>fetch(`${u}/api/watchlist/remove/${t}`,{method:"DELETE",credentials:"include"}));await Promise.all(s),N(t=>t.filter(r=>!m.includes(r._id))),b([]),T(!1),h.success(`${m.length} properties removed from watchlist`)}catch{h.error("Failed to remove some properties")}},ve=()=>{const s=g.map(a=>({name:a.name,type:a.type,price:a.regularPrice,discountPrice:a.discountPrice,city:a.city,state:a.state,bedrooms:a.bedrooms,bathrooms:a.bathrooms,addedDate:new Date(a.createdAt).toLocaleDateString()})),t=[["Property Name","Type","Price","Discount Price","City","State","Bedrooms","Bathrooms","Added Date"],...s.map(a=>[a.name,a.type,a.price,a.discountPrice||"",a.city,a.state,a.bedrooms,a.bathrooms,a.addedDate])].map(a=>a.join(",")).join(`
`),r=new Blob([t],{type:"text/csv"}),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download=`watchlist-${new Date().toISOString().split("T")[0]}.csv`,n.click(),window.URL.revokeObjectURL(l),h.success("Watchlist exported successfully")},we=()=>{const s=`Check out my watchlist with ${c.length} properties!`,t=window.location.href;navigator.share?navigator.share({title:"My Property Watchlist",text:s,url:t}):(navigator.clipboard.writeText(`${s} ${t}`),h.success("Watchlist link copied to clipboard"))},g=c.filter(s=>{var l,n,a;const t=((l=s.name)==null?void 0:l.toLowerCase().includes(v.toLowerCase()))||((n=s.city)==null?void 0:n.toLowerCase().includes(v.toLowerCase()))||((a=s.state)==null?void 0:a.toLowerCase().includes(v.toLowerCase())),r=I==="all"||s.type===I;return t&&r}).sort((s,t)=>{switch(V){case"price-low":return(s.regularPrice||0)-(t.regularPrice||0);case"price-high":return(t.regularPrice||0)-(s.regularPrice||0);case"name":return(s.name||"").localeCompare(t.name||"");case"dateAdded":default:return new Date(t.createdAt||0)-new Date(s.createdAt||0)}});if(ce)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading your watchlist..."})]})});const Se=s=>{const t=R(s);if(t==null)return!1;const r=k.get(s._id);return r==null?!1:t<r},Pe=s=>{const t=R(s);if(t==null)return!1;const r=k.get(s._id);return r==null?!1:t>r},Ae=s=>{const t=C.find(x=>{var y,X;return((X=((y=x.listingId)==null?void 0:y._id)||x.listingIdRaw)==null?void 0:X.toString())===s._id}),r=(t==null?void 0:t.addedAt)||(t==null?void 0:t.createdAt)||null,l=k.get(s._id)??(t==null?void 0:t.effectivePriceAtAdd)??null,n=R(s);let a=null,o="neutral";return l!=null&&n!=null&&(a=n-l,o=a<0?"dropped":a>0?"increased":"neutral"),{addedAt:r,baseline:l,current:n,change:a,status:o}};return e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-100 min-h-screen py-2 sm:py-10 px-1 sm:px-2 md:px-8 overflow-x-hidden",children:[e.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-xl shadow-lg p-2 sm:p-4 lg:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"text-3xl text-purple-700"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-purple-700",children:"My Watchlist"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.length," of ",c.length," properties",p.totalValue>0&&e.jsxs("span",{className:"ml-2 text-purple-600 font-semibold",children:["‚Ä¢ Total Value: ‚Çπ",p.totalValue.toLocaleString("en-IN")]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>J("grid"),className:`p-2 rounded ${j==="grid"?"bg-white shadow":"text-gray-500"}`,title:"Grid View",children:e.jsx(se,{className:"text-sm"})}),e.jsx("button",{onClick:()=>J("list"),className:`p-2 rounded ${j==="list"?"bg-white shadow":"text-gray-500"}`,title:"List View",children:e.jsx(se,{className:"rotate-90 text-sm"})})]}),e.jsxs("button",{onClick:()=>he(!D),className:`px-2 sm:px-3 py-2 rounded-lg transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm ${D?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(te,{className:"text-xs sm:text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Stats"})]}),c.length>0&&e.jsxs("button",{onClick:()=>T(!P),className:`px-2 sm:px-3 py-2 rounded-lg transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm ${P?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(ae,{className:"text-xs sm:text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Select"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:ve,className:"px-2 sm:px-3 py-2 rounded-lg bg-green-100 text-green-700 hover:bg-green-200 transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",disabled:c.length===0,children:[e.jsx(ke,{className:"text-xs sm:text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]}),e.jsxs("button",{onClick:we,className:"px-2 sm:px-3 py-2 rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",disabled:c.length===0,children:[e.jsx(Ie,{className:"text-xs sm:text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Share"})]}),e.jsxs("button",{onClick:()=>z(!O),className:"bg-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(Le,{className:"text-xs sm:text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Properties"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})]}),O&&e.jsxs("div",{className:"mb-6 bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-800",children:"Search and Add Properties"}),e.jsx("button",{onClick:()=>z(!1),className:"text-purple-600 hover:text-purple-800",children:e.jsx(re,{className:"text-lg"})})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search properties by name, city, or state...",value:w,onChange:ue,onKeyPress:s=>s.key==="Enter"&&$(),onFocus:()=>w.length>=2&&f(!0),onBlur:()=>setTimeout(()=>f(!1),200),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),me&&(L.length>0||_)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:[_?e.jsxs("div",{className:"p-3 text-center text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-1 text-sm",children:"Searching..."})]}):L.map(s=>{var t;return e.jsx("div",{onClick:()=>fe(s),className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.imageUrls&&s.imageUrls.length>0?e.jsx("img",{src:s.imageUrls[0],alt:s.name,className:"w-12 h-12 object-cover rounded-md",onError:r=>{r.target.src="https://via.placeholder.com/48x48?text=No+Image"}}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400 text-lg",children:"üè†"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-gray-800 truncate",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 truncate",children:[s.city,", ",s.state]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.type," ‚Ä¢ ",s.bedrooms," bed",s.bedrooms!==1?"s":""," ‚Ä¢ ‚Çπ",(t=s.regularPrice)==null?void 0:t.toLocaleString("en-IN")]})]})]})},s._id)}),L.length===0&&!_&&e.jsx("div",{className:"p-3 text-center text-gray-500",children:e.jsx("p",{className:"text-sm",children:"No properties found"})})]})]}),e.jsx("button",{onClick:$,disabled:K||!w.trim(),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:K?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{}),"Search"]})})]}),U.length>0&&e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:U.map(s=>{var t;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.city,", ",s.state]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.type," ‚Ä¢ ",s.bedrooms," bed",s.bedrooms!==1?"s":""," ‚Ä¢ ‚Çπ",(t=s.regularPrice)==null?void 0:t.toLocaleString("en-IN")]})]}),e.jsx("button",{onClick:()=>be(s),disabled:E(s._id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${E(s._id)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:E(s._id)?"Added":"Add to Watchlist"})]},s._id)})})]}),D&&c.length>0&&e.jsxs("div",{className:"mb-6 bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-4 flex items-center gap-2",children:[e.jsx(te,{className:"text-purple-600"}),"Watchlist Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Properties"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:c.length})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Average Price"}),e.jsxs("p",{className:"text-sm sm:text-2xl font-bold text-green-600",children:["‚Çπ",p.averagePrice.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm col-span-2 lg:col-span-1",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Price Range"}),e.jsxs("p",{className:"text-xs sm:text-lg font-bold text-blue-600",children:["‚Çπ",p.priceRange.min.toLocaleString("en-IN")," - ‚Çπ",p.priceRange.max.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm col-span-2 lg:col-span-1",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-sm sm:text-2xl font-bold text-indigo-600",children:["‚Çπ",p.totalValue.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"By Type"}),e.jsx("div",{className:"space-y-2",children:Object.entries(p.typeDistribution).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 capitalize",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${t/c.length*100}%`}})}),e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:t})]})]},s))})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"By City"}),e.jsx("div",{className:"space-y-2",children:Object.entries(p.cityDistribution).sort((s,t)=>t[1]-s[1]).slice(0,5).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-pink-500 h-2 rounded-full",style:{width:`${t/c.length*100}%`}})}),e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:t})]})]},s))})]})]})]}),P&&e.jsx("div",{className:"mb-6 bg-red-50 p-3 sm:p-4 rounded-lg border border-red-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("button",{onClick:ye,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-300 hover:bg-gray-50 text-sm",children:[e.jsx(ae,{className:"text-sm"}),m.length===g.length?"Deselect All":"Select All"]}),e.jsxs("span",{className:"text-sm text-gray-600 text-center sm:text-left",children:[m.length," of ",g.length," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:Ne,disabled:m.length===0,className:"flex-1 sm:flex-none px-3 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm",children:[e.jsx(le,{className:"text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Remove Selected"}),e.jsx("span",{className:"sm:hidden",children:"Remove"})]}),e.jsxs("button",{onClick:()=>{T(!1),b([])},className:"px-3 sm:px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center justify-center gap-2 text-sm",children:[e.jsx(re,{className:"text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]})]})]})}),c.length>0&&e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search properties by name, city, or state...",value:v,onChange:s=>oe(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"text-gray-500"}),e.jsxs("select",{value:I,onChange:s=>xe(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"sale",children:"For Sale"}),e.jsx("option",{value:"rent",children:"For Rent"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500"}),e.jsxs("select",{value:V,onChange:s=>de(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"dateAdded",children:"Date Added"}),e.jsx("option",{value:"price-low",children:"Price: Low to High"}),e.jsx("option",{value:"price-high",children:"Price: High to Low"}),e.jsx("option",{value:"name",children:"Name: A to Z"})]})]})]})]}),C.some(s=>!s.listingId)&&e.jsxs("div",{className:"mb-6 p-4 rounded-lg border border-yellow-200 bg-yellow-50",children:[e.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Removed or Unavailable"}),e.jsx("div",{className:"space-y-2",children:C.filter(s=>!s.listingId).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-800 font-medium",children:"This property has been removed or is no longer available."}),e.jsx("p",{className:"text-xs text-gray-500",children:"You can remove it from your watchlist."})]}),s.listingIdRaw&&e.jsxs("button",{onClick:()=>Q(s.listingIdRaw),className:"px-3 py-1 rounded bg-red-600 text-white text-sm flex items-center gap-2",children:[e.jsx(le,{className:"text-xs"})," Remove"]})]},s._id))})]}),c.length===0?e.jsxs("div",{className:"text-center py-10 sm:py-16",children:[e.jsx("div",{className:"text-6xl sm:text-8xl mb-4",children:"üëÅÔ∏è"}),e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-2",children:"Your watchlist is empty"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Track properties to get price-drop and availability alerts."}),e.jsxs(De,{to:"/search",className:"inline-flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(A,{}),"Browse Properties"]})]}):g.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üîç"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No properties found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria."})]}):e.jsx("div",{className:j==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4 lg:gap-6":"space-y-4 overflow-x-hidden",children:g.map(s=>{const t=Ae(s),r=t&&t.baseline!=null&&t.current!=null,l=t.status==="dropped"?"text-green-600":t.status==="increased"?"text-red-600":"text-gray-600";return e.jsxs("div",{className:`relative group ${j==="list"?"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border w-full overflow-hidden":""}`,children:[Se(s)&&e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsxs("span",{className:"bg-green-500 text-white text-[10px] sm:text-xs font-semibold px-2 py-1 rounded-full shadow-md flex items-center gap-1",children:[e.jsx(ne,{className:"text-[10px] sm:text-xs"})," Price dropped"]})}),Pe(s)&&e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsxs("span",{className:"bg-red-500 text-white text-[10px] sm:text-xs font-semibold px-2 py-1 rounded-full shadow-md flex items-center gap-1",children:[e.jsx(ie,{className:"text-[10px] sm:text-xs"})," Price increased"]})}),P&&e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",checked:m.includes(s._id),onChange:()=>je(s._id),className:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500"})}),e.jsxs("div",{className:j==="list"?"flex-1":"",children:[e.jsx(Ee,{listing:s,onDelete:Q}),r&&e.jsxs("div",{className:"mt-2 px-2 py-2 bg-gray-50 border rounded-md text-xs sm:text-sm flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(Fe,{className:"text-gray-500"}),e.jsxs("span",{children:["Added: ",t.addedAt?new Date(t.addedAt).toLocaleDateString():"-"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(Re,{className:"text-gray-500"}),e.jsxs("span",{children:["At add: ‚Çπ",Number(t.baseline).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ee,{className:"text-gray-500"}),e.jsxs("span",{children:["Today: ‚Çπ",Number(t.current).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:`flex items-center gap-1 font-semibold ${l}`,children:[t.status==="dropped"&&e.jsx(ne,{}),t.status==="increased"&&e.jsx(ie,{}),t.status==="neutral"&&e.jsx($e,{className:"text-gray-500"}),e.jsxs("span",{children:[t.status==="dropped"&&`Dropped ‚Çπ${Math.abs(t.change).toLocaleString("en-IN")}`,t.status==="increased"&&`Increased ‚Çπ${Math.abs(t.change).toLocaleString("en-IN")}`,t.status==="neutral"&&"No change"]})]})]})]})]},s._id)})})]}),e.jsx("div",{className:"fixed bottom-8 right-8 z-50",children:e.jsxs("button",{onClick:()=>window.location.href="/user/wishlist",className:"relative group w-16 h-16 rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center bg-gradient-to-r from-pink-500 to-red-500",style:{boxShadow:"0 4px 16px rgba(0,0,0,0.15)"},title:"Open Wishlist",children:[e.jsx("span",{className:"w-7 h-7 text-white text-2xl",children:"‚ù§Ô∏è"}),e.jsxs("div",{className:"absolute bottom-full right-0 mb-3 bg-white text-gray-800 text-sm px-4 py-2 rounded-xl shadow-2xl hidden group-hover:block z-10 whitespace-nowrap border border-gray-100 transform -translate-y-1 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"‚ù§Ô∏è"}),e.jsx("span",{className:"font-medium",children:"Wishlist"})]}),e.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white"})]})]})})]})}export{Ve as default};
